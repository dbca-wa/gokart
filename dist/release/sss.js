!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var inserted=exports.cache={};exports.insert=function(css){if(!inserted[css]){inserted[css]=!0;var elem=document.createElement("style");return elem.setAttribute("type","text/css"),"textContent"in elem?elem.textContent=css:elem.styleSheet.cssText=css,document.getElementsByTagName("head")[0].appendChild(elem),elem}}},{}],2:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js"),tour=new _vendor.Shepherd.Tour({defaults:{classes:"shepherd-theme-dark",scrollTo:!1}});tour.version=.1,global.tour=tour,tour.on("cancel",function(){global.gokart.touring=!1}),tour.addStep("welcome",{text:'Would you like a tour of the Spatial Support System? If you exit now, you can always rerun the tour by clicking "Reset SSS" in <b>Layers > Download & Print</b>',buttons:[{text:"Exit",classes:"shepherd-button-secondary",action:tour.cancel},{text:"Next",action:tour.next}]}).addStep("map-controls",{text:"At the top right are common map controls for setting a scale, fullscreen and zooming",attachTo:".ol-zoom bottom",when:{show:function(){global.gokart.map.animatePan([116,-32]),global.gokart.map.animateZoom(global.gokart.map.resolutions[9])}}}).addStep("menu",{text:"To the left are the interactive panes for <b>Layers</b>, <b>Annotations</b> and <b>Vehicle Tracking</b>.",attachTo:"#menu-tab-layers-label right"}).addStep("layers",{text:"The layers pane lets you find, organise and print what is visible on the map",attachTo:"#menu-tab-layers-label right",when:{"before-show":function(){(0,_vendor.$)("#menu-tab-layers-label").click()}}}).addStep("catalogue",{text:"The catalogue in <b>Browse Layers</b> lets you add layers to the map. Layers can be found by typing into the search box.",attachTo:"#menu-tab-layers-label right",when:{"before-show":function(){(0,_vendor.$)("#layers-catalogue-label").click()}}}).addStep("catalogue-toggle",{text:"Clicking a layers switch will add it ontop of other map layers",attachTo:"#menu-tab-layers-label right",when:{"before-show":function(){(0,_vendor.$)("#find-layer").val("tenure").change(),_vendor.Vue.nextTick(function(){(0,_vendor.$)("#layers-catalogue-list .switch-input").click(),(0,_vendor.$)("#find-layer").val("land").change()})}}}).addStep("active",{text:"The map layers in Active lets you configure layers already on the map.",attachTo:"#menu-tab-layers-label right",when:{"before-show":function(){(0,_vendor.$)("#layers-active-label").click()}}}).addStep("active-opacity",{text:"Clicking a layer opens its configuration panel, from which you can adjust opacity and other settings.",attachTo:"#menu-tab-layers-label right",when:{"before-show":function(){(0,_vendor.$)('div[data-id="dpaw:resource_tracking_live"]').click(),_vendor.Vue.nextTick(function(){(0,_vendor.$)("#layer-config input.layer-opacity").val(30).change()})}}}).addStep("active-remove",{text:"You can also reorder layers using drag and drop, and remove a layer by clicking the red X",attachTo:"#menu-tab-layers-label right",when:{"before-show":function(){(0,_vendor.$)('div[data-id="dpaw:resource_tracking_live"] a.remove-layer').get(0).click()}}}).addStep("annotations",{text:"The <b>Annotations</b> pane lets you draw features onto the map.",attachTo:"#menu-tab-annotations-label right",when:{"before-show":function(){(0,_vendor.$)("#menu-tab-annotations-label").click()}}}).addStep("annotations-text",{text:"Some of the tools have additional configuration options. Text notes are even able to be resized.",attachTo:"#menu-tab-annotations-label right",when:{"before-show":function(){(0,_vendor.$)('a[title="Text Note"]').get(0).click(),_vendor.Vue.nextTick(function(){(0,_vendor.$)("textarea.notecontent").height(60).val("Like this one where you\ncan set the text of a note").get(0).click(),global.exampleFeature=new global.ol.Feature({geometry:new global.ol.geom.Point(global.gokart.map.olmap.getView().getCenter())})})}}}).addStep("annotations-draw",{text:"Clicking on the map will place a feature",attachTo:"#menu-tab-annotations-label right",when:{"before-show":function(){_vendor.Vue.nextTick(function(){global.gokart.annotations.features.push(global.exampleFeature)})}}}).addStep("tracking",{text:"The Tracking pane is used to find and filter the vehicles displayed on the map. (END TOUR, will reload now)",attachTo:"#menu-tab-tracking-label right",when:{"before-show":function(){(0,_vendor.$)("#menu-tab-tracking-label").click()},hide:function(){document.location.reload()}}}),exports.default=tour}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"src/vendor.js":"src/vendor.js"}],3:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _vendor=require("src/vendor.js"),_sss=require("./sss.vue"),_sss2=_interopRequireDefault(_sss),_sssTour=require("./sss-tour.js"),_sssTour2=_interopRequireDefault(_sssTour);global.tour=_sssTour2.default,global.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}};var defaultStore={tourVersion:null,whoami:{email:null},catalogueFilters:[["basemap","Base Imagery"],["boundaries","Admin Boundaries"],["communications","Communications"],["operations","DPaW Operations"],["bushfire","Fire"],["infrastructure","Infrastructure"],["meteorology","Meteorology"],["relief","Relief"],["sensitive","Sensitive Sites"]],remoteCatalogue:"https://oim.dpaw.wa.gov.au/catalogue/api/records?format=json&application__name=sss",defaultWMTSSrc:"https://kmi.dpaw.wa.gov.au/geoserver/gwc/service/wmts",defaultWFSSrc:"https://kmi.dpaw.wa.gov.au/geoserver/wfs",defaultLegendSrc:"https://kmi.dpaw.wa.gov.au/geoserver/gwc/service/wms?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER=",gokartService:"https://gokart.dpaw.wa.gov.au",resolutions:[.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.0003433227539062,.0001716613769531,858306884766e-16,429153442383e-16,214576721191e-16,107288360596e-16,53644180298e-16,26822090149e-16,13411045074e-16],fixedScales:[.25,.5,1,2,2.5,5,10,20,25,50,80,100,125,250,500,1e3,2e3,3e3,5e3,1e4,25e3],view:{center:[123.75,-24.966]},activeLayers:[["dpaw:resource_tracking_live",{}],["cddp:smb_250K",{}]],matrixSets:{"EPSG:4326":{1024:{name:"gda94",minLevel:0,maxLevel:17}}},mmPerInch:25.4,annotations:{type:"FeatureCollection",features:[]}};global.gokartService=defaultStore.gokartService,global.localforage=_vendor.localforage,global.$=_vendor.$,_vendor.Vue.use(_vendor.VueStash),_vendor.localforage.getItem("sssOfflineStore").then(function(store){global.gokart=new _vendor.Vue({el:"body",components:{App:_sss2.default},data:{store:_vendor.$.extend(defaultStore,store||{}),pngs:{},saved:null,touring:!1},computed:{map:function(){return this.$refs.app.$refs.map},info:function(){return this.$refs.app.$refs.map.$refs.info},active:function(){return this.$refs.app.$refs.layers.$refs.active},catalogue:function(){return this.$refs.app.$refs.layers.$refs.catalogue},export:function(){return this.$refs.app.$refs.layers.$refs.export},annotations:function(){return this.$refs.app.$refs.annotations},tracking:function(){return this.$refs.app.$refs.tracking},geojson:function(){return new _vendor.ol.format.GeoJSON},wgs84Sphere:function(){return new _vendor.ol.Sphere(6378137)}},ready:function(){var self=this;(0,_vendor.$)(document).foundation(),(0,_vendor.svg4everybody)(),(0,_vendor.$)("body").append('<div id="dpi" style="width:1in;display:none"></div>'),this.dpi=parseFloat((0,_vendor.$)("#dpi").width()),this.store.dpmm=self.dpi/self.store.mmPerInch,(0,_vendor.$)("#dpi").remove(),function(){var req=new window.XMLHttpRequest;req.withCredentials=!0,req.onload=function(){self.whoami=JSON.parse(this.responseText)},req.open("GET","https://oim.dpaw.wa.gov.au/api/whoami"),req.send()}();var offCanvasLeft=(0,_vendor.$)("#offCanvasLeft");(0,_vendor.$)("#menu-tabs").on("change.zf.tabs",function(ev){offCanvasLeft.addClass("reveal-responsive"),self.map.olmap.updateSize()}).on("click",".tabs-title a[aria-selected=false]",function(ev){offCanvasLeft.addClass("reveal-responsive"),(0,_vendor.$)(this).attr("aria-selected",!0),self.map.olmap.updateSize()}).on("click",".tabs-title a[aria-selected=true]",function(ev){offCanvasLeft.removeClass("reveal-responsive"),(0,_vendor.$)(this).attr("aria-selected",!1),self.map.olmap.updateSize()}),(0,_vendor.$)("#side-pane-close").on("click",function(ev){offCanvasLeft.removeClass("reveal-responsive"),(0,_vendor.$)("#menu-tabs").find(".tabs-title a[aria-selected=true]").attr("aria-selected",!1),self.map.olmap.updateSize()});var resourceTrackingStyle=function(res){var feat=this,style=self.$refs.app.cacheStyle(function(feat){var src=self.$refs.app.getBlob(feat,["icon","tint"]);return!!src&&new _vendor.ol.style.Style({image:new _vendor.ol.style.Icon({src:src,scale:.5,snapToPixel:!0}),text:new _vendor.ol.style.Text({offsetX:12,textAlign:"left",font:"12px Helvetica,Roboto,Arial,sans-serif",stroke:new _vendor.ol.style.Stroke({color:"#fff",width:4})}),stroke:new _vendor.ol.style.Stroke({color:[52,101,164,.6],width:4})})},feat,["icon","tint"]);return style.getText&&(res<.002?style.getText().setText(feat.get("label")):style.getText().setText("")),style},addResource=function(f){var tint="red";f.get("age")<24&&(tint="orange"),f.get("age")<3&&(tint="yellow"),f.get("age")<=1&&(tint="green"),f.set("icon","dist/static/symbols/device/"+f.get("symbolid")+".svg"),f.set("tint",tint),f.set("baseTint",tint),f.set("label",f.get("name")||f.get("callsign")||f.get("rego")||f.get("deviceid")),f.set("time",(0,_vendor.moment)(f.get("seen")).toLocaleString()),f.set("partialId","resourceInfo"),f.set("selectId",f.get("deviceid")),f.setStyle(resourceTrackingStyle)},iconStyle=function(feat,res){var style=self.$refs.app.cacheStyle(function(feat){var src=self.$refs.app.getBlob(feat,["icon","tint"]);if(!src)return!1;var rot=feat.get("rotation")||0;return new _vendor.ol.style.Style({image:new _vendor.ol.style.Icon({src:src,scale:.5,rotation:rot,rotateWithView:!0,snapToPixel:!0})})},feat,["icon","tint","rotation"]);return style},getPerpendicular=function(coords){var nearestFeature=gokart.annotations.featureOverlay.getSource().getClosestFeatureToCoordinate(coords,function(feat){var geom=feat.getGeometry();return geom instanceof _vendor.ol.geom.Polygon||geom instanceof _vendor.ol.geom.LineString});if(!nearestFeature)return 0;var segments=[],source=[],segLength=0;nearestFeature.getGeometry()instanceof _vendor.ol.geom.Polygon?(source=nearestFeature.getGeometry().getCoordinates()[0],segLength=source.length):(source=nearestFeature.getGeometry().getCoordinates(),segLength=source.length-1);for(var i=0;i<segLength;i++)segments.push([source[i],source[(i+1)%source.length]]);segments.sort(function(a,b){return _vendor.ol.coordinate.squaredDistanceToSegment(coords,a)-_vendor.ol.coordinate.squaredDistanceToSegment(coords,b)});var offset=[segments[0][1][0]-segments[0][0][0],segments[0][1][1]-segments[0][0][1]],normal=Math.atan2(-offset[1],offset[0]);return normal},catalogue=[{type:"WFSLayer",name:"Resource Tracking",id:"dpaw:resource_tracking_live",onadd:addResource,refresh:30},{type:"WFSLayer",name:"Resource Tracking History",id:"dpaw:resource_tracking_history",onadd:addResource,cql_filter:!1},{type:"TileLayer",name:"Firewatch Hotspots 72hrs",id:"landgate:firewatch_ecu_hotspots_last_0_72",format:"image/png",refresh:60},{type:"TimelineLayer",name:"Himawari-8 Hotspots",id:"himawari8:hotspots",source:this.store.gokartService+"/hi8/AHI_TKY_FHS",params:{FORMAT:"image/png"},refresh:300},{type:"TimelineLayer",name:"Himawari-8 True Colour",id:"himawari8:bandtc",source:this.store.gokartService+"/hi8/AHI_TKY_b321",refresh:300,base:!0},{type:"TimelineLayer",name:"Himawari-8 Band 3",id:"himawari8:band3",source:this.store.gokartService+"/hi8/AHI_TKY_b3",refresh:300,base:!0},{type:"TimelineLayer",name:"Himawari-8 Band 7",id:"himawari8:band7",source:this.store.gokartService+"/hi8/AHI_TKY_b7",refresh:300,base:!0},{type:"TimelineLayer",name:"Himawari-8 Band 15",id:"himawari8:band15",source:this.store.gokartService+"/hi8/AHI_TKY_b15",refresh:300,base:!0},{type:"TileLayer",name:"State Map Base",id:"cddp:smb_250K",base:!0},{type:"TileLayer",name:"Virtual Mosaic",id:"landgate:LGATE-V001",base:!0}],iconDrawFactory=function(options){var defaultFeat=new _vendor.ol.Feature({icon:options.icon}),draw=new _vendor.ol.interaction.Draw({type:"Point",features:options.features,style:function(feat,res){return iconStyle(defaultFeat,res)}});return draw.on("drawstart",function(ev){if(ev.feature.set("icon",options.icon),options.perpendicular){var coords=ev.feature.getGeometry().getCoordinates();ev.feature.set("rotation",getPerpendicular(coords))}}),draw},originPointDraw=iconDrawFactory({icon:"dist/static/symbols/fire/origin.svg",features:this.annotations.features,tint:"default"}),spotFireDraw=iconDrawFactory({icon:"dist/static/symbols/fire/spotfire.svg",features:this.annotations.features,tint:"default"}),divisionDraw=iconDrawFactory({icon:"dist/static/symbols/fire/division.svg",features:this.annotations.features,tint:"default",perpendicular:!0}),sectorDraw=iconDrawFactory({icon:"dist/static/symbols/fire/sector.svg",features:this.annotations.features,tint:"default",perpendicular:!0}),fireBoundaryStyle=new _vendor.ol.style.Style({stroke:new _vendor.ol.style.Stroke({width:4,color:[0,0,0,1]}),fill:new _vendor.ol.style.Fill({color:[0,0,0,.25]})}),fireBoundaryDraw=new _vendor.ol.interaction.Draw({type:"Polygon",features:this.annotations.features,style:fireBoundaryStyle}),snapToLines=new _vendor.ol.interaction.Snap({features:this.annotations.features,edge:!0,vertex:!1,pixelTolerance:16}),sssTools=[{name:"Origin Point",icon:"dist/static/symbols/fire/origin.svg",interactions:[originPointDraw],style:function(res){return iconStyle(this,res)},showName:!0,selectedTint:[["#b43232","#2199e8"]]},{name:"Spot Fire",icon:"dist/static/symbols/fire/spotfire.svg",interactions:[spotFireDraw],style:function(res){return iconStyle(this,res)},showName:!0,selectedTint:[["#b43232","#2199e8"]]},{name:"Division",icon:"dist/static/symbols/fire/division.svg",interactions:[divisionDraw,snapToLines],style:function(res){return iconStyle(this,res)},showName:!0},{name:"Sector",icon:"dist/static/symbols/fire/sector.svg",interactions:[sectorDraw,snapToLines],style:function(res){return iconStyle(this,res)},showName:!0},{name:"Fire Boundary",icon:"dist/static/images/iD-sprite.svg#icon-area",style:fireBoundaryStyle,interactions:[fireBoundaryDraw],showName:!0},self.annotations.ui.defaultText,self.annotations.ui.defaultLine,self.annotations.ui.defaultPolygon];sssTools.forEach(function(tool){self.annotations.tools.push(tool)}),this.map.init(catalogue,this.store.activeLayers),this.catalogue.loadRemoteCatalogue(this.store.remoteCatalogue,function(){self.store.tourVersion!==_sssTour2.default.version&&(self.store.tourVersion=_sssTour2.default.version,self.export.saveState(),self.touring=!0,_sssTour2.default.start())})}})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./sss-tour.js":2,"./sss.vue":4,"src/vendor.js":"src/vendor.js"}],4:[function(require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var __vueify_insert__=require("vueify/lib/insert-css");__vueify_insert__.insert("#tracking-list .feature-row{cursor:pointer;border-right:1px transparent}#tracking-list .feature-row:hover{border-right:1px solid #fff}.feature-row.device-selected{background-color:#165016}.feature-row:nth-child(even).device-selected{background-color:#185a18}");Object.defineProperty(exports,"__esModule",{value:!0});var _map=require("../components/map.vue"),_map2=_interopRequireDefault(_map),_layers=require("../components/layers.vue"),_layers2=_interopRequireDefault(_layers),_annotations=require("../components/annotations.vue"),_annotations2=_interopRequireDefault(_annotations),_tracking=require("../components/sss/tracking.vue"),_tracking2=_interopRequireDefault(_tracking),_vendor=require("src/vendor.js");exports.default={components:{gkMap:_map2.default,gkLayers:_layers2.default,gkAnnotations:_annotations2.default,gkTracking:_tracking2.default},data:function(){var fill="#ff6600",stroke="#7c3100";return{tints:{red:[[fill,"#ed2727"],[stroke,"#480000"]],orange:[[fill,"#ff6600"],[stroke,"#562200"]],yellow:[[fill,"#ffd700"],[stroke,"#413104"]],green:[[fill,"#71c837"],[stroke,"#1b310d"]],selected:[["#000000","#2199e8"],[stroke,"#2199e8"],[fill,"#ffffff"]]},svgTemplates:{},svgBlobs:{},styles:{}}},methods:{tintSVG:function(svgstring,tints){return tints.forEach(function(colour){svgstring=svgstring.split(colour[0]).join(colour[1])}),svgstring},cacheStyle:function(styleFunc,feature,keys){var key=keys.map(function(k){return feature.get(k)}).join(";"),style=this.styles[key];return style?style:(style=styleFunc(feature),style?(this.styles[key]=style,style):_vendor.ol.style.defaultStyleFunction())},getBlob:function(feature,keys){var vm=this,key=keys.map(function(k){return feature.get(k)}).join(";");if(this.svgBlobs[key])return this.svgBlobs[key];var dims=feature.get("dims")||[48,48],tint=feature.get("tint"),url=feature.get("icon");new Promise(function(resolve,reject){vm.addSVG(key,url,tint,dims,resolve)}).then(function(){feature.changed()})},addSVG:function(key,url,tint,dims,pResolve){var vm=this;tint=tint||[],"string"==typeof tint&&(tint=vm.tints[tint]||[]);var draw=function(){"undefined"!=typeof vm.svgBlobs[key]&&pResolve(),vm.svgBlobs[key]="";new Promise(function(resolve,reject){vm.drawSVG(key,vm.svgTemplates[url],tint,dims,resolve,reject)}).then(function(){pResolve()})};if(vm.svgTemplates[url])vm.svgTemplates[url]instanceof Promise?vm.svgTemplates[url].then(draw):draw();else{var loadJob=new Promise(function(resolve,reject){var req=new window.XMLHttpRequest;req.withCredentials=!0,req.onload=function(){this.responseText&&(vm.svgTemplates[url]=this.responseText,resolve())},req.onerror=function(){reject()},req.open("GET",url),req.send()}).then(draw);url in vm.svgTemplates||(vm.svgTemplates[url]=loadJob)}},drawSVG:function(key,svgstring,tints,dims,resolve,reject){var vm=this,canvas=$("<canvas>");canvas.attr({width:dims[0],height:dims[1]}),canvas.drawImage({source:"data:image/svg+xml;utf8,"+encodeURIComponent(vm.tintSVG(svgstring,tints)),fromCenter:!1,x:0,y:0,width:dims[0],height:dims[1],load:function(){canvas.get(0).toBlob(function(blob){vm.svgBlobs[key]=window.URL.createObjectURL(blob),resolve()},"image/png")}})}}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class=off-canvas-wrapper><div class=off-canvas-wrapper-inner data-off-canvas-wrapper=""><div class="off-canvas position-left reveal-responsive" id=offCanvasLeft data-off-canvas=""><a id=side-pane-close class="button alert hide-for-medium">✕</a><div class="tabs-content vertical" data-tabs-content=menu-tabs><gk-layers v-ref:layers=""></gk-layers><gk-annotations v-ref:annotations=""></gk-annotations><gk-tracking v-ref:tracking=""></gk-tracking></div></div><div class=off-canvas-content data-off-canvas-content=""><ul class="tabs vertical map-widget" id=menu-tabs data-tabs=""><li class="tabs-title side-button is-active"><a href=#menu-tab-layers title="Map Layers" @click="$root.annotations.setTool(\'Pan\')"><svg class=icon><use xlink:href=dist/static/images/iD-sprite.svg#icon-layers></use></svg></a><li class="tabs-title side-button"><a href=#menu-tab-annotations title=Annotations @click=$root.annotations.init()><i class="fa fa-pencil" aria-hidden=true></i></a><li class="tabs-title side-button"><a href=#menu-tab-tracking title="Vehicle Tracking" @click=$root.tracking.init()><i class="fa fa-truck" aria-hidden=true></i></a></ul><gk-map v-ref:map=""></gk-map></div></div></div><div class=hide><div v-for="blob in svgBlobs"><img v-bind:src=blob></div></div>'},{"../components/annotations.vue":5,"../components/layers.vue":7,"../components/map.vue":12,"../components/sss/tracking.vue":13,"src/vendor.js":"src/vendor.js","vueify/lib/insert-css":1}],5:[function(require,module,exports){var __vueify_insert__=require("vueify/lib/insert-css");__vueify_insert__.insert(".notecontent{width:100%;height:100px;resize:both;background-image:url(dist/static/images/boxresize.svg);background-repeat:no-repeat;background-position:100% 100%}.canvaspane{overflow:hidden;width:100px;height:30vh}.row.resetmargin{margin:0}.resetmargin .small-6.rightmargin{margin-right:1px}.resetmargin .small-6{margin-right:-1px;padding-right:1px}.resetmargin .expanded.button{margin-bottom:2px}.fa.red{color:#b43232}");Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js");_vendor.Vue.filter("filterIf",function(list,prop,value){if(list)return list.filter(function(val){return val&&val[prop]===value})});var noteOffset=20,notePadding=10,noteStyles={general:function(note){var textTmpl={fontSize:"16px",fontFamily:'"Helvetica Neue",Helvetica,Roboto,Arial,sans-serif',text:note.text,x:noteOffset+notePadding,y:notePadding,align:"left",maxWidth:note.width+notePadding*-2,fromCenter:!1};return[["drawText",_vendor.$.extend({strokeWidth:3,strokeStyle:"rgba(255, 255, 255, 0.9)"},textTmpl)],["drawText",_vendor.$.extend({fillStyle:note.colour},textTmpl)]]}};exports.default={data:function(){return{ui:{},tool:{},tools:[],features:new _vendor.ol.Collection,selectedFeatures:new _vendor.ol.Collection,selectable:[],featureOverlay:{},featureEditing:{},note:{style:"general",text:"Sector: \nChannel: \nCommander: ",colour:"#000000"},notes:{},size:2,colour:"#000000",colours:[["red","#cc0000"],["orange","#f57900"],["yellow","#edd400"],["green","#73d216"],["blue","#3465a4"],["violet","#75507b"],["brown","#8f5902"],["grey","#555753"],["black","#000000"]],advanced:!1}},methods:{downloadAnnotations:function(){this.$root.export.exportVector(this.features.getArray(),"annotations")},icon:function(t){return t.icon.startsWith("fa-")?'<i class="fa '+t.icon+'" aria-hidden="true"></i>':t.icon.search("#")===-1?'<img class="icon" src="'+t.icon+'" />':'<svg class="icon"><use xlink:href="'+t.icon+'"></use></svg>'},setProp:function(prop,value){this[prop]=value,this.featureEditing instanceof _vendor.ol.Feature&&this.featureEditing.set(prop,value)},getTool:function(toolName){return this.tools.filter(function(t){return t.name===toolName})[0]},editFeature:function(f){this.featureEditing=f,this.setTool(this.getTool(f.get("toolName"))),f.get("note")&&(this.note=_vendor.$.extend({},f.get("note")),this.drawNote(f.get("note"))),f.get("size")&&(this.size=f.get("size")),f.get("colour")&&(this.colour=f.get("colour"))},setTool:function(t){"string"==typeof t&&(t=this.getTool(t)),this.featureEditing.get&&t.name===this.featureEditing.get("toolName")||(this.featureEditing={});var map=this.$root.map;this.tools.forEach(function(tool){tool.interactions.forEach(function(inter){map.olmap.removeInteraction(inter)})}),t.interactions.forEach(function(inter){map.olmap.addInteraction(inter)}),this.selectedFeatures.clear(),this.$root.active.hoverInfo="Pan"===t.name&&this.$root.active.hoverInfoCache;var catalogue=this.$root.catalogue;map.getMapLayer("annotations")||catalogue.onLayerChange(catalogue.getLayer("annotations"),!0),this.tool=t},selectAll:function(){var vm=this;this.features.forEach(function(feature){feature in vm.selectedFeatures||vm.selectedFeatures.push(feature)})},deleteSelected:function(){var vm=this;this.selectedFeatures.forEach(function(feature){vm.features.remove(feature)}),this.selectedFeatures.clear()},updateNote:function(save){var note=this.note;this.featureEditing.get&&(note=this.featureEditing.get("note")||note),note.text=this.$els.notecontent.value,note.width=(0,_vendor.$)(this.$els.notecontent).width(),note.height=(0,_vendor.$)(this.$els.notecontent).height(),note.colour=this.colour,this.drawNote(note,save)},drawNote:function(note,save){if(note){var vm=this,noteCanvas=this.$els.textpreview;if((0,_vendor.$)(noteCanvas).clearCanvas(),note.style&&note.style in noteStyles&&((0,_vendor.$)(noteCanvas).attr("height",note.height+noteOffset),(0,_vendor.$)(noteCanvas).attr("width",note.width+noteOffset),noteStyles[note.style](note).forEach(function(cmd){(0,_vendor.$)(noteCanvas)[cmd[0]](cmd[1])}),save)){var key=JSON.stringify(note);this.notes[key]="",noteCanvas.toBlob(function(blob){vm.notes[key]=window.URL.createObjectURL(blob),vm.features.getArray().forEach(function(f){JSON.stringify(f.get("note"))===key&&f.changed()}),vm.drawNote(vm.note,!1)},"image/png")}}},getNoteUrl:function(note){var key=JSON.stringify(note);return key in this.notes||this.drawNote(note,!0),this.notes[key]},init:function(){this.selectable=[this.featureOverlay],this.setTool("Edit")}},ready:function(){var vm=this,map=this.$root.map;this.features.on("add",function(ev){var feature=ev.element,tool=null;feature.get("toolName")?tool=vm.getTool(feature.get("toolName")):(feature.set("toolName",vm.tool.name),tool=vm.tool),feature.set("tint",tool.tint||"default"),tool.onAdd&&tool.onAdd(feature),feature.setStyle(tool.style||null)});var savedFeatures=this.$root.geojson.readFeatures(this.$root.store.annotations);this.$on("gk-init",function(){savedFeatures&&this.features.extend(savedFeatures)}),this.selectedFeatures.on("add",function(ev){var feature=ev.element;feature.set("baseTint",feature.get("tint"));var tool=vm.getTool(feature.get("toolName"));tool?feature.set("tint",tool.selectedTint||"selected"):feature.set("tint","selected")}),this.selectedFeatures.on("remove",function(ev){var feature=ev.element;feature.set("tint",feature.get("baseTint"))}),this.featureOverlay=new _vendor.ol.layer.Vector({source:new _vendor.ol.source.Vector({features:this.features})}),this.featureOverlay.set("id","annotations"),this.featureOverlay.set("name","My Annotations"),this.ui.pointInter=new _vendor.ol.interaction.Draw({type:"Point",features:this.features}),this.ui.lineInter=new _vendor.ol.interaction.Draw({type:"LineString",features:this.features}),this.ui.polyInter=new _vendor.ol.interaction.Draw({type:"Polygon",features:this.features}),this.ui.translateInter=new _vendor.ol.interaction.Translate({layers:[this.featureOverlay],features:this.selectedFeatures}),this.ui.modifyInter=new _vendor.ol.interaction.Modify({features:this.features}),this.ui.dragSelectInter=new _vendor.ol.interaction.DragBox,this.ui.dragSelectInter.on("boxend",function(event){var extent=event.target.getGeometry().getExtent();vm.selectable.forEach(function(layer){layer.getSource().forEachFeatureIntersectingExtent(extent,function(feature){vm.selectedFeatures.push(feature)})})}),this.ui.dragSelectInter.on("boxstart",function(){vm.selectedFeatures.clear()}),this.ui.selectInter=new _vendor.ol.interaction.Select({layers:function(layer){return vm.selectable.indexOf(layer)>-1},features:this.selectedFeatures}),this.ui.keyboardInter=new _vendor.ol.interaction.Interaction({handleEvent:function(mapBrowserEvent){var stopEvent=!1;if(mapBrowserEvent.type===_vendor.ol.events.EventType.KEYDOWN){var keyEvent=mapBrowserEvent.originalEvent;switch(keyEvent.keyCode){case 65:keyEvent.ctrlKey&&(vm.selectAll(),stopEvent=!0);break;case 46:vm.deleteSelected(),stopEvent=!0}}return stopEvent&&keyEvent.preventDefault(),!stopEvent}}),this.tool=this.ui.defaultPan={name:"Pan",icon:"fa-hand-paper-o",interactions:[map.dragPanInter,map.doubleClickZoomInter,map.keyboardPanInter,map.keyboardZoomInter]},this.ui.defaultSelect={name:"Select",icon:"fa-mouse-pointer",interactions:[this.ui.keyboardInter,this.ui.dragSelectInter,this.ui.selectInter,this.ui.translateInter]},this.ui.defaultEdit={name:"Edit",icon:"fa-pencil",interactions:[this.ui.keyboardInter,this.ui.selectInter,this.ui.dragSelectInter,this.ui.modifyInter]},this.tools=[this.ui.defaultPan,this.ui.defaultSelect,this.ui.defaultEdit];var noteStyleCache={},noteStyle=function(res){var f=this,url="";return f?(url=vm.getNoteUrl(f.get("note")),noteStyleCache[url]||(noteStyleCache[url]=new _vendor.ol.style.Style({image:new _vendor.ol.style.Icon({anchorOrigin:"bottom-left",anchor:[0,0],src:url})})),noteStyleCache[url]):null},noteDraw=new _vendor.ol.interaction.Draw({type:"Point",features:this.features});this.ui.defaultText={name:"Text Note",icon:"fa-comment",style:noteStyle,interactions:[noteDraw],showName:!0,onAdd:function(f){f.get("note")||f.set("note",_vendor.$.extend({},vm.note))}};var customAdd=function(f){f.get("size")||f.set("size",vm.size),f.get("colour")||f.set("colour",vm.colour)},vectorStyleCache={default:_vendor.ol.style.defaultStyleFunction()},vectorStyle=function(res){var f=this,key="default";return f&&(key=f.get("size")+";"+f.get("colour")+";"+f.get("tint")),vectorStyleCache[key]||("selected"===f.get("tint")?vectorStyleCache[key]=[new _vendor.ol.style.Style({fill:new _vendor.ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new _vendor.ol.style.Stroke({color:"#2199e8",width:2*f.get("size")+2})}),new _vendor.ol.style.Style({stroke:new _vendor.ol.style.Stroke({color:"#ffffff",width:2*f.get("size")})})]:vectorStyleCache[key]=new _vendor.ol.style.Style({fill:new _vendor.ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new _vendor.ol.style.Stroke({color:f.get("colour"),width:2*f.get("size")})})),vectorStyleCache[key]};this.ui.defaultLine={name:"Custom Line",icon:"dist/static/images/iD-sprite.svg#icon-line",interactions:[this.ui.lineInter],showName:!0,onAdd:customAdd,style:vectorStyle},this.ui.defaultPolygon={name:"Custom Area",icon:"dist/static/images/iD-sprite.svg#icon-area",interactions:[this.ui.polyInter],showName:!0,onAdd:customAdd,style:vectorStyle},this.$root.catalogue.catalogue.push({type:"Annotations",id:"annotations",name:"My Annotations"})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class=tabs-panel id=menu-tab-annotations v-cloak=""><div class="row collapse"><div class=columns><ul class=tabs data-tabs="" id=annotations-tabs><li class="tabs-title is-active"><a href=#annotations-edit aria-selected=true>Annotations</a></ul></div></div><div class="row collapse" id=annotations-tab-panels><div class=columns><div class="tabs-content vertical" data-tabs-content=annotations-tabs><div class="tabs-panel is-active" id=annotations-edit v-cloak=""><div class="tool-slice row collapse"><div class=small-2><label class=tool-label>Tool:</label></div><div class=small-10><div class="expanded button-group"><a v-for="t in tools | filterIf \'showName\' undefined" class="button button-tool" v-bind:class="{\'selected\': t.name == tool.name}" @click=setTool(t) v-bind:title=t.name>{{{ icon(t) }}}</a> <a class="button button-tool" v-bind:class="{\'disabled\': selectedFeatures.getArray().length !== 1}" @click=editFeature(selectedFeatures.getArray()[0]) title="Edit selected feature"><i class="fa fa-pencil-square-o"></i></a></div><div class="row resetmargin"><div class="small-6 rightmargin"><a v-for="t in tools | filterIf \'showName\' true" v-if="$index % 2 === 0" class="expanded secondary button" v-bind:class="{\'selected\': t.name == tool.name}" @click=setTool(t) v-bind:title=t.name>{{{ icon(t) }}} {{ t.name }}</a></div><div class=small-6><a v-for="t in tools | filterIf \'showName\' true" v-if="$index % 2 === 1" class="expanded secondary button" v-bind:class="{\'selected\': t.name == tool.name}" @click=setTool(t) v-bind:title=t.name>{{{ icon(t) }}} {{ t.name }}</a></div></div></div></div><div class="tool-slice row collapse"><div class=small-2><label class=tool-label>Ops:</label></div><div class=small-10><div class="expanded button-group hide"><a class=button><i class="fa fa-cut" aria-hidden=true></i> Cut</a> <a class=button><i class="fa fa-copy" aria-hidden=true></i> Copy</a> <a class=button><i class="fa fa-paste" aria-hidden=true></i> Paste</a></div><div class="expanded button-group hide"><a class=button><i class="fa fa-undo" aria-hidden=true></i> Undo</a> <a class=button><i class="fa fa-repeat" aria-hidden=true></i> Redo</a></div><div class="expanded button-group"><a class=button><i class="fa fa-upload" aria-hidden=true></i> Upload Boundary</a> <a class=button @click=downloadAnnotations()><i class="fa fa-download" aria-hidden=true></i> Export Annotations</a></div></div></div><div v-show="tool.name.startsWith(\'Custom\')" class="tool-slice row collapse"><div class=small-2><label class=tool-label>Size:<br>({{ size }})</label></div><div class=small-10><div class="expanded button-group"><a @click="setProp(\'size\', 1)" v-bind:class="{\'selected\': size == 1}" class=button><img src=dist/static/images/thick-1.svg></a><a @click="setProp(\'size\', 2)" v-bind:class="{\'selected\': size == 2}" class=button><img src=dist/static/images/thick-2.svg></a><a @click="setProp(\'size\', 4)" v-bind:class="{\'selected\': size == 4}" class=button><img src=dist/static/images/thick-4.svg></a></div></div></div><div v-show="tool.name.startsWith(\'Custom\') || tool.name.startsWith(\'Text\')" class="tool-slice row collapse"><div class=small-2><label class=tool-label>Colour:</label></div><div class=small-10><div @click=updateNote(false) class="expanded button-group"><a v-for="c in colours" class=button title="{{ c[0] }}" @click="setProp(\'colour\', c[1])" v-bind:class="{\'selected\': c[1] == colour}" v-bind:style="{ backgroundColor: c[1] }"></a></div></div></div><div v-show="tool.name == \'Text Note\'" class="tool-slice row collapse"><div class=small-2>Note:</div><div class=small-10><select name=select @change="note.text = $event.target.value.split(\'<br>\').join(\'\\n\')"><option value="">Text Templates<option value="Sector: <br>Channel: <br>Commander: " selected>Sector Details</select><textarea @blur=updateNote(true) class=notecontent v-el:notecontent="" @keyup=updateNote(false) @click=updateNote(true) @mouseup=updateNote(false)>{{ note.text }}</textarea></div></div><div class="tool-slice row collapse"><div class="small-12 canvaspane"><canvas v-show="tool.name == \'Text Note\'" v-el:textpreview=""></canvas></div></div></div></div></div></div></div>';
},{"src/vendor.js":"src/vendor.js","vueify/lib/insert-css":1}],6:[function(require,module,exports){var __vueify_insert__=require("vueify/lib/insert-css");__vueify_insert__.insert(".feature-icon{width:24px;height:24px}");Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js");exports.default={data:function(){return{enabled:!1,features:!1,coordinate:"",offset:20,pixel:[0,0]}},computed:{featuresLength:function(){return Object.keys(this.features).length},css:function css(){var map=this.$root.map,css={left:this.pixel[0]+this.offset+"px",top:this.pixel[1]+this.offset+"px",bottom:map.height-this.pixel[1]+this.offset+"px",right:map.width-this.pixel[0]+this.offset+"px",display:"none"};return this.pixel[0]<map.width/2?delete css.right:delete css.left,this.pixel[1]<map.height/2?delete css.bottom:delete css.top,this.pixel[0]>0&&this.enabled&&delete css.display,css}},methods:{ago:function(time){return(0,_vendor.moment)(time).fromNow()},onPointerMove:function(event){if(!event.dragging&&this.enabled){var pixel=this.$root.map.olmap.getEventPixel(event.originalEvent),features=[];this.$root.map.olmap.forEachFeatureAtPixel(pixel,function(f){features.push(f)}),features.length>0?(this.features=features,this.coordinate=_vendor.ol.coordinate.toStringXY(this.$root.map.olmap.getCoordinateFromPixel(pixel),3),this.pixel=pixel):this.pixel.$set(0,0)}},selected:function(f){return this.$root.annotations.selectedFeatures.getArray().indexOf(f)>-1}},ready:function(){this.$on("gk-init",function(){this.$root.map.olmap.on("pointermove",this.onPointerMove)})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div id=info v-bind:style=css v-show=features v-cloak=""><div class="row collapse"><div class="columns title"><h5>{{ featuresLength }} {{ featuresLength | pluralize \'feature\' }} <small>{{ coordinate }}</small></h5></div><button class="close-button float-right" aria-label="Dismiss info" type=button v-on:click="features = false"><span aria-hidden=true>×</span></button></div><div class=row><div class="columns content"><div v-for="f in features" class="row feature-row" v-bind:class="{\'device-selected\': selected(f) }" track-by="get(\'id\')"><div v-if="f.get(\'partialId\') !== \'resourceInfo\'" class=columns>{{ f.getId() }}</div><div v-if="f.get(\'partialId\') === \'resourceInfo\'" class=columns><div class=feature-title><img class=feature-icon v-bind:src="$root.$refs.app.getBlob(f, [\'icon\', \'tint\'])"> {{ f.get(\'label\') }} <i><small>seen {{ ago(f.get(\'seen\')) }}</small></i></div></div></div></div></div></div>'},{"src/vendor.js":"src/vendor.js","vueify/lib/insert-css":1}],7:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _active=require("./layers/active.vue"),_active2=_interopRequireDefault(_active),_catalogue=require("./layers/catalogue.vue"),_catalogue2=_interopRequireDefault(_catalogue),_export=require("./layers/export.vue"),_export2=_interopRequireDefault(_export);exports.default={components:{gkActive:_active2.default,gkCatalogue:_catalogue2.default,gkExport:_export2.default}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class="tabs-panel is-active" id=menu-tab-layers><div class="row collapse"><div class=columns><ul class=tabs data-tabs="" id=layers-tabs><li class="tabs-title is-active"><a href=#layers-active aria-selected=true>Active</a><li class=tabs-title><a href=#layers-catalogue>Browse Layers</a><li class=tabs-title><a href=#layers-export>Download &amp; Print</a></ul></div></div><div class="row collapse" id=layers-tab-panels><div class=columns><div class="tabs-content vertical" data-tabs-content=layers-tabs><gk-active v-ref:active=""></gk-active><gk-catalogue v-ref:catalogue=""></gk-catalogue><gk-export v-ref:export=""></gk-export></div></div></div></div>'},{"./layers/active.vue":8,"./layers/catalogue.vue":9,"./layers/export.vue":10}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js");exports.default={data:function(){return{sliderOpacity:0,layer:{},olLayers:[],hoverInfoCache:!1,timeIndex:0}},computed:{graticule:{cache:!1,get:function(){return this.$root.map.graticule&&this.$root.map.graticule.getMap()===this.$root.map.olmap}},hoverInfo:{cache:!1,get:function(){return this.$root.info.enabled},set:function(val){this.$root.info.enabled=val}},sliderTimeline:{get:function(){return this.timeIndex=this.mapLayer().get("timeIndex"),this.timeIndex},set:function(val){this.mapLayer().set("timeIndex",val),this.timeIndex=val}},timelineTS:function(){return this.layer.timeline[this.timeIndex][0]},sliderMax:function(){return this.layer.timeline.length-1},layerOpacity:{get:function(){return Math.round(100*this.mapLayer().getOpacity())},set:function(val){this.mapLayer().setOpacity(val/100)}}},methods:{activeLayers:function(){var catalogue=this.$root.catalogue,results=[],success=this.olLayers.every(function(layer){var catLayer=catalogue.getLayer(layer);if(!catLayer)return!1;var options={id:layer.get("id"),name:layer.get("name"),type:catLayer.type,opacity:layer.getOpacity()};return results.push([layer.get("id"),options]),!0});return!!success&&results.reverse()},mapLayer:function(id){return this.$root.map.getMapLayer(id||this.layer)},getLayer:function(id){return this.$root.catalogue.getLayer(id)},toggleGraticule:function(){var map=this.$root.map;this.graticule?map.graticule.setMap(null):map.graticule.setMap(map.olmap)},toggleHoverInfo:function(ev){this.hoverInfoCache=ev.target.checked,this.hoverInfo=ev.target.checked},update:function(){var vm=this;vm.olLayers=[],_vendor.Vue.nextTick(function(){vm.olLayers=vm.$root.map.olmap.getLayers().getArray()})},removeLayer:function(olLayer){this.$root.map.olmap.removeLayer(olLayer)},updateOrder:function(el){var map=this.$root.map;Array.prototype.slice.call(el.parentNode.children).reverse().forEach(function(row){var layer=map.getMapLayer(row.dataset.id);map.olmap.removeLayer(layer),map.olmap.addLayer(layer)})}},ready:function(){(0,_vendor.dragula)([document.querySelector("#layers-active-list")]).on("dragend",this.updateOrder),this.$on("gk-init",function(){this.olLayers=this.$root.map.olmap.getLayers().getArray()})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class="tabs-panel is-active" id=layers-active v-cloak=""><div class="layers-topframe scroller row"><div class=columns><div class=row><div class="switch tiny"><input class=switch-input id=toggleGraticule type=checkbox v-bind:checked=graticule @change=toggleGraticule><label class=switch-paddle for=toggleGraticule><span class=show-for-sr>Display graticule</span></label></div><label for=toggleGraticule class=side-label>Display graticule</label></div><div class="row show-for-medium"><div class="switch tiny"><input class=switch-input id=toggleHoverInfo type=checkbox v-bind:checked=hoverInfo @change=toggleHoverInfo><label class=switch-paddle for=toggleHoverInfo><span class=show-for-sr>Display hovering feature info</span></label></div><label for=toggleHoverInfo class=side-label>Display hovering feature info</label></div><div id=layers-active-list><div v-for="l in olLayers.slice().reverse()" class="row layer-row" v-bind:class=l.progress data-id="{{ l.get(\'id\') }}" track-by=values_.id @click="layer = getLayer(l.get(\'id\'))"><div class=small-9><div class=layer-title>{{ l.get("name") }} - {{ Math.round(l.getOpacity() * 100) }}%</div><small v-if="l.get(\'updated\')">Updated: {{ l.get("updated") }}</small></div><div class=small-3><div class=text-right><a @click=removeLayer(l) class="button alert remove-layer">✕</a></div></div></div></div></div></div><div class="row collapse"><div id=layer-config class=columns><h4 v-if=mapLayer()>{{ layer.name }}</h4><div class="tool-slice row" v-if=mapLayer()><div class="columns small-2"><label class=tool-label>Opacity:<br>{{ layerOpacity }}%</label></div><div class="columns small-10"><input class=layer-opacity type=range min=1 max=100 step=1 v-model=layerOpacity></div></div><div class="tool-slice row" v-if=layer.timeline><div class="columns small-2"><label class=tool-label>Timeline:<br>{{ timelineTS }}</label></div><div class="columns small-10"><input type=range v-bind:max=sliderMax min=0 step=1 v-model=sliderTimeline></div></div></div></div></div>'},{"src/vendor.js":"src/vendor.js"}],9:[function(require,module,exports){var __vueify_insert__=require("vueify/lib/insert-css");__vueify_insert__.insert(".short.button{margin:0}@media screen and (max-width:60em){.ol-overviewmap{display:none}}.ol-overviewmap{width:424px;height:100vh;z-index:1}.ol-overviewmap .ol-overviewmap-map{width:100%;height:100%;border:0;margin:0}div.ol-overviewmap.ol-uncollapsible{background-color:rgba(51,61,70,.9)}.ol-overviewmap .ol-overviewmap-map .ol-overviewmap-box{display:none}.cat-legend{max-height:50vh}");Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js");_vendor.Vue.filter("lessThan",function(value,length){return value.length<length}),exports.default={store:["catalogueFilters","defaultLegendSrc"],data:function(){return{layer:{},catalogue:new _vendor.ol.Collection,swapBaseLayers:!0,search:"",searchAttrs:["name","id","tags"],overview:!1,layerDetails:!1}},methods:{preview:function(l){if(this.layer!==l){if(this.layer.preview&&this.layer.preview.setMap(null),!l)return void(this.layer={});l.preview||(l.preview=new _vendor.ol.control.OverviewMap({layers:[this.$root.map["create"+l.type](l)],collapsed:!1,collapsible:!1,view:new _vendor.ol.View({projection:"EPSG:4326"})})),l.preview.setMap(this.$root.map.olmap);var previewEl=(0,_vendor.$)(l.preview.getOverviewMap().getTargetElement());this.layer=l,!previewEl.find(".layerdetails").length>0&&this.$nextTick(function(){previewEl.prepend(this.$els.layerdetails.innerHTML)})}},toggleAll:function(checked,event){var switches=(0,_vendor.$)(this.$el).find("input.ctlgsw");switches.attr("checked",!checked).trigger("click")},onToggle:function(index){(0,_vendor.$)(this.$el).find("#ctlgsw"+index).trigger("click")},onLayerChange:function(layer,checked){var vm=this,active=this.$root.active,map=this.$root.map;if(checked!==(void 0!==map.getMapLayer(layer)))if(checked){var olLayer=map["create"+layer.type](layer);olLayer.setOpacity(layer.opacity||1),layer.base?(this.swapBaseLayers&&active.olLayers.forEach(function(mapLayer){vm.getLayer(mapLayer).base&&active.removeLayer(mapLayer)}),map.olmap.getLayers().insertAt(0,olLayer)):map.olmap.addLayer(olLayer)}else active.removeLayer(map.getMapLayer(layer))},loadRemoteCatalogue:function(url,callback){var vm=this,req=new window.XMLHttpRequest;req.withCredentials=!0,req.onload=function(){JSON.parse(this.responseText).forEach(function(l){vm.getLayer(l.identifier)&&vm.catalogue.remove(vm.getLayer(l.identifier)),l.base=l.tags.some(function(t){return"basemap"===t.name}),l.tags.some(function(t){return"overlaymap"===t.name})&&(l.opacity=.5),vm.catalogue.push(l)}),callback()},req.open("GET",url),req.send()},getLayer:function(id){return id&&id.get&&(id=id.get("id")),this.catalogue.getArray().find(function(layer){return layer.id===id})},getMapLayer:function(id){return this.$root.map.getMapLayer(id)}},ready:function(){var vm=this;this.catalogue.on("add",function(event){var l=event.element;l.id=l.id||l.identifier,l.name=l.name||l.title,l.type=l.type||"TileLayer","TileLayer"===l.type&&(l.legend=l.legend||vm.defaultLegendSrc+l.id)}),this.$on("gk-init",function(){var vm=this;(0,_vendor.$)(this.$root.map.olmap.getTargetElement()).on("mouseleave",".ol-overviewmap",function(){vm.preview(!1)})})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class=tabs-panel id=layers-catalogue v-cloak=""><div class=row><div class=columns><div class="row collapse"><div class="small-6 columns"><select name=select v-model=search><option value="" selected>All layers<option v-for="filter in catalogueFilters" v-bind:value=filter[0]>{{ filter[1] }}<option v-bind:value=search>Custom search</select></div><div class="small-6 columns"><input id=find-layer type=search v-model=search placeholder="Find a layer"></div></div><div v-show="search.length > 0 &amp;&amp; search !== \'basemap\'" class=row><div class="columns text-right"><label for=switchBaseLayers class=side-label>Toggle all</label></div><div class="small-2 text-right"><div class="switch tiny"><input class=switch-input title="Toggle all filtered layers" id=ctlgswall @change="toggleAll($event.target.checked, $event)" type=checkbox><label class=switch-paddle for=ctlgswall><span class=show-for-sr>Toggle all</span></label></div></div></div><div class=row v-show="search === \'basemap\'"><div class="switch tiny"><input class=switch-input id=switchBaseLayers type=checkbox v-model=swapBaseLayers><label class=switch-paddle for=switchBaseLayers><span class=show-for-sr>Switch out base layers</span></label></div><label for=switchBaseLayers class=side-label>Switch out base layers automatically</label></div><div id=layers-catalogue-list><div v-for="l in catalogue.getArray() | filterBy search in searchAttrs | orderBy \'name\'" class="row layer-row" @mouseover=preview(l) @click=onToggle($index) track-by=id @mouseleave=preview(false)><div class=small-10><a @click.stop="" href="https://oim.dpaw.wa.gov.au/django-admin/catalogue/record/?identifier={{ l.id }}" target=_blank class="button tiny secondary float-right short"><i class="fa fa-pencil"></i></a><div class=layer-title>{{ l.name || l.id }}</div></div><div class=small-2><div class=text-right><div class="switch tiny" @click.stop=""><input class="switch-input ctlgsw" id="ctlgsw{{ $index }}" @change="onLayerChange(l, $event.target.checked)" v-bind:checked="getMapLayer(l) !== undefined" type=checkbox><label class=switch-paddle for="ctlgsw{{ $index }}"><span class=show-for-sr>Toggle layer</span></label></div></div></div></div></div><div v-el:layerdetails="" class=hide><div class="layerdetails row"><div class="columns small-12">{{ layer.name }}<br>Details: TODO <img v-if=layer.legend src="{{ layer.legend }}" class=cat-legend></div></div></div></div></div></div>'},{"src/vendor.js":"src/vendor.js","vueify/lib/insert-css":1}],10:[function(require,module,exports){(function(global){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js"),_legend=require("./legend.vue"),_legend2=_interopRequireDefault(_legend);exports.default={store:["whoami","dpmm","view","mmPerInch","gokartService"],components:{gkLegend:_legend2.default},data:function(){return{minDPI:100,paperSizes:{A0:[1189,841],A1:[841,594],A2:[594,420],A3:[420,297],A4:[297,210]},paperSize:"A3",layout:{},title:"Quick Print",statefile:"",vectorFormat:"json",states:[]}},computed:{olmap:function(){return this.$root.map.olmap},mapLayout:function(){var dims=this.paperSizes[this.paperSize],size=this.olmap.getSize();return{width:dims[0],height:dims[1],size:size,extent:this.olmap.getView().calculateExtent(size),scale:this.scale,dpmm:this.dpmm}},shortUrl:{cache:!1,get:function(){if(this.olmap){var lonlat=this.olmap.getView().getCenter();return _vendor.$.param({lon:lonlat[0],lat:lonlat[1],scale:Math.round(1e3*this.$root.map.getScale())})}}}},methods:{legendInfo:function(){var result={km:(Math.round(40*this.$root.map.getScale())/1e3).toLocaleString(),scale:"ISO "+this.paperSize+" "+this.$root.map.scaleString,title:this.title,author:this.whoami.email,date:"Printed "+(0,_vendor.moment)().toLocaleString()};return result},exportVector:function(features,name){var name=name||"",result=this.$root.geojson.writeFeatures(features),blob=new window.Blob([result],{type:"application/json;charset=utf-8"});if("json"===this.vectorFormat)(0,_vendor.saveAs)(blob,name+"_"+(0,_vendor.moment)().add((0,_vendor.moment)().utcOffset(),"minutes").toISOString().split(".")[0]+".geo.json");else{var formData=new window.FormData;formData.append("json",blob,name+".json");var req=new window.XMLHttpRequest;req.open("POST",this.gokartService+"/ogr/"+this.vectorFormat),req.responseType="blob",req.onload=function(event){(0,_vendor.saveAs)(req.response,name+"."+format)},req.send(formData)}},setSize:function(){(0,_vendor.$)("body").css("cursor","progress"),this.layout=this.mapLayout,this.dpmm=this.minDPI/this.mmPerInch,this.olmap.setSize([this.dpmm*this.layout.width,this.dpmm*this.layout.height]),this.olmap.getView().fit(this.layout.extent,this.olmap.getSize()),this.$root.map.setScale(this.$root.map.getFixedScale())},resetSize:function(){this.olmap.setSize(this.layout.size),this.dpmm=this.layout.dpmm,this.olmap.getView().fit(this.layout.extent,this.olmap.getSize()),this.$root.map.setScale(this.layout.scale),(0,_vendor.$)("body").css("cursor","default")},renderLegend:function(){var qrcanvas=(0,_vendor.kjua)({text:"http://dpaw.io/sss?"+this.shortUrl,render:"canvas",size:100});return["data:image/svg+xml;utf8,"+encodeURIComponent(this.$els.legendsvg.innerHTML),qrcanvas]},blobGDAL:function(blob,name,format){var formData=new window.FormData;formData.append("extent",this.layout.extent.join(" ")),formData.append("jpg",blob,name+".jpg"),formData.append("dpi",Math.round(25.4*this.layout.canvasPxPerMM)),formData.append("title",this.title),formData.append("author",this.legendInfo().author);var req=new window.XMLHttpRequest;req.open("POST",this.gokartService+"/gdal/"+format),req.responseType="blob";var vm=this;req.onload=function(event){(0,_vendor.saveAs)(req.response,name+"."+format),vm.resetSize()},req.send(formData)},print:function(format){this.setSize();var timer,vm=this,composing=vm.olmap.on("postcompose",function(event){timer&&clearTimeout(timer),timer=setTimeout(function(){vm.olmap.unByKey(composing);var canvas=event.context.canvas,img=new window.Image,legend=vm.renderLegend(),url=legend[0],qrcanvas=legend[1];img.onerror=function(err){window.alert(JSON.stringify(err))},img.onload=function(){vm.layout.canvasPxPerMM=canvas.width/vm.layout.width;var height=120*vm.layout.canvasPxPerMM*img.height/img.width;canvas.getContext("2d").drawImage(img,0,0,120*vm.layout.canvasPxPerMM,height),canvas.getContext("2d").drawImage(qrcanvas,8,height),window.URL.revokeObjectURL(url);var filename=vm.title.replace(" ","_");canvas.toBlob(function(blob){"jpg"===format?((0,_vendor.saveAs)(blob,filename+".jpg"),vm.resetSize()):vm.blobGDAL(blob,filename,format)},"image/jpeg",.9)},img.src=url},5e3)});vm.olmap.renderSync()},download:function(key){key?_vendor.localforage.getItem("sssStateStore").then(function(store){if(key in store){var blob=new window.Blob([JSON.stringify(store[key],null,2)],{type:"application/json;charset=utf-8"});(0,_vendor.saveAs)(blob,key+".sss.json")}}):_vendor.localforage.getItem("sssOfflineStore").then(function(store){var blob=new window.Blob([JSON.stringify(store,null,2)],{type:"application/json;charset=utf-8"});(0,_vendor.saveAs)(blob,"sss_state_"+(0,_vendor.moment)().format("YYYY-MM-DD-HHmm")+".sss.json")})},open:function(key){_vendor.localforage.getItem("sssStateStore").then(function(store){key in store&&_vendor.localforage.setItem("sssOfflineStore",store[key]).then(function(v){document.location.reload()})})},remove:function(key){var vm=this;_vendor.localforage.getItem("sssStateStore").then(function(store){key in store&&(delete store[key],vm.states=Object.keys(store),_vendor.localforage.setItem("sssStateStore",store))})},load:function(){var vm=this,reader=new window.FileReader,key=this.$els.statefile.files[0].name.split(".",1)[0];reader.onload=function(e){_vendor.localforage.getItem("sssStateStore").then(function(store){store[key]=JSON.parse(e.target.result),_vendor.localforage.setItem("sssStateStore",store).then(function(v){vm.states=Object.keys(store)})})},reader.readAsText(this.$els.statefile.files[0])},reset:function(){window.confirm("This will clear all of your selected layers and annotations. Are you sure?")&&_vendor.localforage.removeItem("sssOfflineStore").then(function(v){document.location.reload()})},saveStateButton:function(){var key=this.$els.savestatename.value;key||(key=(0,_vendor.moment)().format("DD/MM/YYYY HH:mm")),this.saveState(key)},saveState:function(key){var vm=this,store=this.$root.store;if(!vm.$root.touring){store.view.center=vm.olmap.getView().getCenter(),store.view.scale=Math.round(1e3*vm.$root.map.getScale());var activeLayers=vm.$root.active.activeLayers();activeLayers!==!1&&(store.activeLayers=activeLayers||[],store.annotations=JSON.parse(vm.$root.geojson.writeFeatures(vm.$root.annotations.features.getArray())),_vendor.localforage.setItem("sssOfflineStore",store).then(function(value){vm.$root.saved=(0,_vendor.moment)().toLocaleString()}),key&&_vendor.localforage.getItem("sssStateStore",function(err,value){var states={};value&&(states=value),states[key]=store,_vendor.localforage.setItem("sssStateStore",states).then(function(value){vm.states=Object.keys(states)})}))}}},ready:function(){this.$on("gk-init",function(){var vm=this;this.olmap.on("postrender",global.debounce(function(ev){vm.saveState()},1e3,!0));_vendor.localforage.getItem("sssStateStore",function(err,value){value&&(vm.states=Object.keys(value))})})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class=tabs-panel id=layers-export v-cloak=""><div id=map-export-controls><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Name:</label></div><div class=small-9><input id=export-name type=text v-model=title></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Paper size:</label></div><div class=small-9><select v-model=paperSize><option v-for="size in paperSizes" v-bind:value=$key>ISO {{ $key }} ({{ size[0] }}mm × {{ size[1] }}mm)</select></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Download:</label></div><div class=small-9><div class="expanded button-group"><a class=button title="JPG for quick and easy printing" @click="print(\'jpg\')"><i class="fa fa-file-image-o"></i><br>JPG</a> <a class=button title="Geospatial PDF for use in PDF Maps and Adobe Reader" @click="print(\'pdf\')"><i class="fa fa-print"></i><br>PDF</a> <a class=button title="GeoTIFF for use in QGIS on the desktop" @click="print(\'tif\')"><i class="fa fa-picture-o"></i><br>GeoTIFF</a></div></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Vector format:</label></div><div class=small-9><select name=select v-model=vectorFormat><option value=json selected>GeoJSON (web GIS)<option value=kml>KML (Google Earth)<option value=geopkg>Geopackage (high performance)<option value=shapefile>Shapefile (legacy desktop GIS)<option value=csv>CSV (Spreadsheet/Excel)</select></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Export state:</label></div><div class="small-9 columns"><div class="expanded button-group"><a class="button expanded" @click=download()><i class="fa fa-download"></i> Download state as file</a></div></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Save state:</label></div><div class="small-9 columns"><div class=input-group><input v-el:savestatename="" class=input-group-field type=text placeholder="Name for saved state"><div class=input-group-button><a class=button @click=saveStateButton()>Save</a></div></div></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Load state:</label></div><div class="small-9 columns"><div v-for="state in states" class=feature-row style="overflow: hidden"><div class="float-right button-group small"><a class=button title="Open state" @click=open(state)><i class="fa fa-folder-open"></i></a> <a class=button title="Download state" @click=download(state)><i class="fa fa-download"></i></a> <a class="button alert" title="Delete state" @click=remove(state)>✕</a></div>{{ state }}</div><div v-if="states.length == 0" class=feature-row>No saved states yet</div><div class="expanded button-group"><label class="button expanded" for=uploadFile><i class="fa fa-upload"></i> Upload state file</label><input type=file id=uploadFile class=show-for-sr name=statefile accept=application/json v-model=statefile v-el:statefile="" @change=load()></div></div></div><div class="tool-slice row collapse"><div class=small-3><label class=tool-label>Reset:</label></div><div class=small-9><div class="expanded button-group"><a id=reset-sss class="button alert" title="Clear current config and annotations" @click=reset()><i class="fa fa-refresh"></i> Reset SSS</a></div></div></div><div class=hide v-el:legendsvg=""><gk-legend></gk-legend></div></div></div>'}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./legend.vue":11,"src/vendor.js":"src/vendor.js"}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={computed:{legendInfo:{cache:!1,get:function(){return this.$root.export.legendInfo()}},title:function(){return this.$root.export.title}}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg xmlns:rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# xmlns=http://www.w3.org/2000/svg height=1.5cm width=14cm version=1.1 y=0 x=0 xmlns:cc=http://creativecommons.org/ns# xmlns:dc=http://purl.org/dc/elements/1.1/ ><g font-size=none stroke-width=1.6615 fill-opacity=.86275 mix-blend-mode=normal transform="matrix(1.4459 0 0 1.0021 1.8503 30.266)" text-anchor=none stroke=#000 style=mix-blend-mode:normal stroke-miterlimit=10 font-weight=none fill=#fff><rect fill-opacity=.86275 height=51.378 width=341.42 stroke=#000 stroke-miterlimit=10 y=-29.373 x=-.44898 stroke-width=1.6615 fill=#fff /></g><g transform="matrix(2.8669 0 0 2.8669 2.3366 -2969.4)"><rect height=13 width=13 y=1039.4 x=2 fill=#fff /><g fill=#003862 transform="matrix(.21667 0 0 .21667 -56.963 809.08)"><g transform="matrix(1.448 0 0 -1.448 306.28 1063.2)"><path d="m0 0c0.048-0.173 0.35-0.361 0.801-0.334 0.443 0.026 1.034-0.006 0.832-0.536-0.201-0.533 0.405-0.376 0.844-0.067 0.204 0.145-0.482 0.664-1.396 1.211h-1.271c0.108-0.13 0.176-0.231 0.19-0.274" fill=#003862 /></g><g transform="matrix(1.448 0 0 -1.448 292.57 1079.2)"><path d="m0 0c-0.287 0.333-0.899 0.097-0.749 0.313 0.151 0.218 1.721 0 1.721 0 0.134-0.177 0.211-0.52-0.405-0.7-0.618-0.182-1.051 0.317-0.948 0.387 0.107 0.068 0.671-0.336 0.381 0m12.611-5.832c-0.494-0.146-0.026 0.371-0.5-0.334-0.472-0.703-0.606 0.711-2.105 1.226 0 0-0.234 0.108 0.177 0.371 0.411 0.266 0.292 0.24-0.196 0.257-0.485 0.017 0.104-0.824-1.007-0.57-1.101 0.255-1.925 0.726-1.76 0.26 0.163-0.466 0.127-0.062 1.349-0.453 1.219-0.388 0.85-0.031 1.285-0.489 0.432-0.455 0.272-0.165-0.289-0.377-0.565-0.214 0.186-0.447-0.112-0.522-0.296-0.073-0.442 0.765-3.191 1.076 0 0-1.058-0.01 0.186-0.429 1.246-0.418 0.691-0.438 0.965-0.429 0.281 0.011 0.3 0.239 0.48-0.005 0.181-0.245 0.225-0.44 1.129-0.57 0.905-0.132 0.562 0.156 0.732-0.031 0.173-0.186-0.372-0.079-0.003-0.293 0.367-0.212 0.298 0.128 0.169-0.292-0.135-0.419-0.536-0.17-0.713-0.296 0 0-0.106-0.15 0.382-0.145 0.485 0.011 0.395 0.06 0.311-0.164-0.086-0.223-0.122-0.18 0.106-0.143 0.227 0.041-0.283-0.372-0.784-0.312-0.494 0.062 0.256 0.573-0.952 1.077-1.212 0.503-0.92 0.292-0.871 0.198s0.973-0.309 0.928-0.628c-0.05-0.32 0.177-0.074 0.255-0.306 0.075-0.233-0.277-0.147-0.535-0.147-0.261 0.004-0.218-0.016-0.41 0.297-0.189 0.314-0.457-0.09-0.796 0.243-0.337 0.336 0.126 0.436-0.464 0.261-0.593-0.174-0.724-0.268-0.616 0.472 0.109 0.74-0.012 0.181 0.358 0.213 0.367 0.034 0.803 0.059 0.127 0.415-0.677 0.356-0.8-0.169-1.494 0.211-0.69 0.377-1.211 0.631-1.762 0.36s-2.528-0.896-2.705 0.679c-0.177 1.574-0.826 0.554-1.268 1.258-0.443 0.706 0.338 2.205 1.13 2.076 0.795-0.131 0.039-0.674 0.924-0.536 0.887 0.136-0.021 0.001 0.054-0.544 0.079-0.544 0.098 0.253 0.696 0.554 0.598 0.303 0.239-0.529 2.012-0.383 0 0-0.434-0.598 0.152-0.573 0.595 0.02 0.257 0.294 0.229 0.762-0.023 0.469-0.587 0.234-1.033 0.732-0.443 0.496-0.844 0.397-1.129 1.198 0 0-0.104 0.089-0.235 0.244-0.13 0.154 0.194 0.024 0.396-0.034 0.202-0.057 0.575-0.583 0.988-0.618 0.413-0.036 1.382-0.715 1.234-0.944-0.144-0.228-0.086-0.163 0.21-0.167 0.298-0.005 1.535-0.188 1.546-0.411 0.015-0.223-0.449-0.722-0.106-0.647 0.345 0.076 1.072 0.145 0.84 0.505-0.228 0.361-1.289 1.109-2.217 1.361-0.925 0.259-2.32 0.888-2.874 1.404-0.55 0.515-1.119 0.482-1.776 0.845-0.656 0.363-1.939 0.551-0.755 0.453 1.187-0.098 0.507 0.048 0.267 0.162-0.237 0.116 0.81-0.053 1.848-0.37 1.038-0.319 1.715-1.049 2.363-1.172 0.652-0.12 1.24-0.599 1.535-0.693 0.3-0.095 0.114 0.089-0.173 0.297s-0.667 0.379-0.757 0.638c-0.095 0.26-0.373 0.252-0.444 0.285-0.066 0.033-0.021 0.021 0.022 0.054 0 0 0.084 0.155 0.482-0.017 0.404-0.172-0.389 0.266-0.467 0.546-0.078 0.281 0.454-0.065 0.839-0.33 0.386-0.265 2.519-1.493 2.812-1.511 0.296-0.018 0.258-0.403 0.125-0.498-0.132-0.095 0.167-0.355 0.59-0.287 0.427 0.064 2.588-1.26 3.237-1.317 0.649-0.063-0.068-0.488 0.673-0.45 0.736 0.035 1.234-0.711 0.937-0.919-0.293-0.212-0.06-0.239 0.228-0.188 0.292 0.052-0.313-1.301-0.809-1.446m-1.447-8.442c-0.064-0.505-0.695-0.156-0.991-0.105-0.297 0.051-0.403 0.116-0.082-0.083 0.322-0.2-0.064-0.526-0.064-0.526-1.071 0.583-1.485 1.576-1.589 1.303-0.102-0.273-0.72-1.598-1.565-0.804-0.853 0.796-0.859-0.195-0.993 0.367-0.132 0.564 0.284 0.473 0.385 0.601 0.106 0.13-0.059 0.297-0.293 0.305-0.228 0.008-0.13-0.578-0.322-0.643-0.197-0.069-0.986 0.147-2.183 0.676-1.2 0.533-1.077 0.109-1.73 0.43-0.658 0.319-0.666 0.081-0.822 0.298-0.154 0.213-0.025 0.493-0.524 0.673-0.499 0.184-1.359 0.876-0.821 0.679 0.538-0.188 0.323 0.083-0.044 0.332-0.37 0.25-0.659 0.357-0.217 0.317 0.44-0.038 0.615-0.188 1.212-0.689 0.594-0.499 0.698-0.164 0.772-0.572 0.075-0.411 0.115-0.37 0.59-0.376 0.468-0.009 0.648-0.087 0.828-0.367 0.182-0.281 0.49-0.171 0.49-0.171 1.16-0.317 0.209 0.358 0.209 0.358-1.175 0.334-3.089 1.662-3.089 1.662-1.029 1.072-2.095 0.548-1.992 1.085 0.102 0.539-0.985 0.559-1.578 0.409-0.592-0.152-0.33-0.228-0.425 0.227-0.098 0.45-0.6-0.012-1.053-0.022-0.453-0.008 0.218 0.18-0.409 0.236-0.628 0.057-0.733-0.392-0.575 0.149 0.163 0.539-0.223 0.248-0.223 0.248-0.517-0.38-0.502 0.24-0.29 1.187 0.218 0.946 0.395-0.293 0.421 0.17 0.023 0.464-0.037 0.868 0.348 0.69 0.384-0.177 0.303 0.071 0.427 0.281 0.121 0.212 1.105-0.355 1.357-0.51 0.253-0.153 0.828-0.022 0.828-0.022 0.594-0.158-0.031-0.626-0.031-0.626-0.397-0.006-0.037-0.157-0.037-0.157 0.276-0.152 0.491 0.011 0.491 0.011-0.025 0.271-0.098 0.835 0.389 0.56 0.489-0.275 0.588-0.147 0.588-0.147 0.281 0.491 0.303-0.263 0.408-0.114 0.104 0.147 0.301 0.086 0.301 0.086 2.22-0.718 2.08-0.463 2.08-0.463-0.062 0.214 0.014 0.21 0.278 0.274 0.266 0.069-0.191 0.364 0.147 0.411 0.339 0.048 0.447-0.243 0.683-0.352 0.242-0.107 0.236 0.122 0.483 0.043 0.246-0.079-0.032-0.519 0.102-0.638 0.132-0.12 0.139 0.681 0.144 0.617 0.007-0.061 0.234-0.011 0.234-0.011 1.081 0.196 1.94 0.092 1.94 0.092s0.238-0.344-0.261-0.733c-0.504-0.389 0.518-0.471 1.334-0.57 0.82-0.1 0.576 0.122 1.763-0.402 1.189-0.52 0.504 0.028 1.642-0.073 1.134-0.098-0.224-0.283 0.013-0.281 0.236 0.003 0.045-0.313 0.31-0.36 0.268-0.054-0.623-0.458-2.358 0.09l-1.035 0.119c-1.029 0.116-0.112-0.177 0.414-0.514 0.519-0.335 1.698-1.018 2.751-0.935 1.055 0.081 0.47-0.571 0.133-0.797-0.343-0.222 0.046-0.704-0.397-0.215-0.443 0.492-0.32 0.085-0.535 0.346-0.217 0.26-0.136 0-0.298 0.023-0.078 0.01-0.117-0.026-0.133-0.052-0.01-0.022-0.013-0.019 0 0 0.003 0.007 0.004 0.007 0.008 0.021 0.027 0.121-0.077 0.193-0.077 0.193-0.822 0.093-0.564 0.617-0.865 0.146-0.298-0.471 1.874-1.056 2.303-1.066 0.428-0.011 0.36-0.114 0.36-0.114-0.799-0.67-2.869 0.495-3.684 0.768-0.814 0.276-2.393 0.897-2.782 1.142-0.389 0.246-0.408 0.003-0.408 0.003 1.578-1.346 2.774-1.342 3.015-1.494 0.243-0.147 0.937 0.227 0.68-0.103-0.261-0.33 0.188-0.338 0.188-0.338 0.91 0.208-0.14-0.159 0.418-0.13 0.557 0.03 0.82-0.047 0.664-0.169-0.158-0.125-0.417-0.323-0.131-0.336 0.285-0.016 0.513 0.09 0.315-0.186-0.2-0.281 1.046-0.567 1.709-0.943 0.66-0.376 0.808 0.086 0.751-0.419m-12.108 17.428c0.035 0.531 0.636 0.276 0.636 0.276 0.824-0.234 0.245 0.026 0.245 0.026-0.113 0.091-0.108 0.49 0.182 0.492 0.294 0.003 0.714-0.798 0.714-0.798 0.106-0.147 0.174 0.02 0.174 0.02 0.461 0.379 0.563-0.128 0.515-0.108-0.045 0.023-0.404-0.14-0.273-0.378 0.135-0.239 0.851-0.314 1.61-0.588 0.75-0.274 0.144-0.467-0.038-0.44-0.177 0.025-1.155 0.194-0.057-0.224 1.097-0.418 0.472-0.565 0.472-0.565-0.394 0.353-2.942 1.562-3.495 1.941-0.55 0.381-0.724-0.185-0.685 0.346m15.82 8.156c0.021-0.2 0.03-0.383 0.03-0.529 0.79-0.308 1.558-0.564 1.763-0.483 0.444 0.174 0.206-0.052 0.187-0.071-0.017-0.018-0.505-0.486 0.171-0.528 0.675-0.042 0.576-0.083 0.634-0.141 0.057-0.059-0.904-0.342 0.482-0.358 0 0 0.431 0.049 0.24-0.199-0.192-0.247-0.267-0.353 0.049-0.385 0.312-0.033 0.271-0.025 0.115-0.319-0.152-0.294-0.436-1.046-0.848-1.072 0 0-0.116-0.099-0.081 0.155 0.032 0.254-0.081 0.034-0.153-0.173-0.08-0.211-0.319-0.503-0.424-0.218-0.105 0.283-0.331 0.001-0.389-0.06-0.057-0.059-0.479 0.197-0.978 0.842-0.497 0.647-0.406 0.468-0.705 0.438-0.296-0.028-0.884-0.193-1.63 0.134-0.742 0.327-2.061 0.308-1.566 0.011 0.491-0.297 1.967-0.141 2.379-0.438 0.419-0.297 1.259-0.47 0.879-0.761-0.376-0.292-0.513 0.164-0.557-0.1-0.042-0.265 0.101-0.526-0.255-0.359-0.358 0.166-0.286 0.633-1.539 0.58-1.248-0.053-2.398 1.015-1.403 0.091 0.993-0.923 0.794-0.075 1.822-0.87 1.031-0.794 1.17-0.459 1.569-0.389 0.394 0.07-0.147-0.345 0.402-0.323 0.547 0.022-0.235-0.829-0.695-0.459-0.458 0.37 0.057-0.44 0.656-0.516 0.604-0.077-1.004-0.912-1.09 0.225 0 0-0.983 1.132-1.513 0.736-0.535-0.397 0.057 0.054 1.116-0.698 0 0 0.04-0.167-0.146-0.161-0.189 0.005 0.719-0.342-0.326-0.221s0.094-0.242 0.84-0.393c0.752-0.151 0.621 0.268 1.011-0.309 0.39-0.576 0.005-0.402-0.41-0.432s-0.403-0.313-1.886 0.284c-1.488 0.597-1.884 0.112-0.687-0.311 1.204-0.425 1.747-0.546 1.802-0.796 0 0 0.061 0.136 0.548-0.077 0.492-0.215 1.326 0.022 1.148-0.373-0.177-0.393 0.11-0.503-0.295-0.628 0 0-0.134-0.004-0.115 0.129 0.021 0.133-0.167-0.003-0.089-0.327 0.077-0.327 0.006-0.096-0.078-0.186-0.085-0.09 0.742-0.449 1.174-0.589 0.433-0.142-0.005-0.187-0.4 0-0.396 0.188-0.407-0.09 0.251-0.259 0.657-0.167-0.792-0.058-1.486 0.287-0.696 0.343-1.154 0.088-2.312 0.842-1.15 0.755-3.145 1.35-3.505 1.322-0.358-0.029 0.426-0.306 0.915-0.556 0.486-0.253 0.256-0.173 0.402-0.33 0.146-0.156 0.868-0.594 1.385-0.586 0.522 0.008 0.618 0.001 0.844-0.146 0.225-0.151-0.097-0.395 0.479-0.326 0.581 0.074-0.027-0.23 0.559-0.24 0.583-0.009 0.459 0.157 0.248-0.426 0 0-0.082-0.044 0.142 0 0.223 0.044 0.256 0.102 0.199-0.115-0.061-0.22 0.142-0.353 0.323-0.386 0.185-0.034-0.052 0.065 0.344-0.106 0.397-0.171 0.966-0.535 1.771-0.76 0 0 0.168-0.015-0.052-0.203-0.218-0.189-0.234-0.241-0.129-0.275 0.104-0.035-0.067-0.082-0.534 0.076l-0.469 0.158s-0.153-0.12 0.133-0.204c0.292-0.082-0.049-0.439-0.091-0.447-0.036-0.006-0.714 0.373-0.824 0.757-0.111 0.385-0.617 0.844-0.727 0.622-0.108-0.223-0.397-0.665-0.547-0.586-0.15 0.08-0.354-0.3-0.316-0.401 0.037-0.103-0.371-0.122-0.824 0.155-0.453 0.281-0.536 0.496-0.969 0.418-0.432-0.079 0.174 0.508 0.301 0.496 0.128-0.014 0.287 0.144-0.216 0.256-0.504 0.113-0.037-0.139-0.362-0.555-0.322-0.413 0.032 0.191-1.094 0.34-1.129 0.149-1.543 0.46-1.39 0.687 0.155 0.231 1.302 0.011-0.629 0.914-1.926 0.902-1.975 1.101-2.047 0.837-0.076-0.262 0.969-0.221 1.037-0.713 0.065-0.495-0.408-0.418 0.218-0.338 0.628 0.08 1.08-0.106 1.092-0.272 0.018-0.168-0.359-1.044-0.522-0.61-0.164 0.434-0.611 0.247-0.835 0.4-0.226 0.151-0.256 0.101-0.229 0.276 0.022 0.174-0.215-0.224-0.289-0.143-0.074 0.082-0.013 0.375-0.645 0.653 0 0 0.152 0.133-0.006 0.237-0.161 0.109 0.051-0.268-0.102-0.03-0.155 0.237-0.395 0.098-0.343 0.43 0.051 0.328-0.082 0.353-0.311 0.509-0.22 0.154 0.269 0.117 0.315 0.052 0.05-0.066 0.222-0.217 0.258-0.074 0.035 0.142-0.793 0.762-1.667 0.963 0 0 0.23 0.238-0.134 0.507s-1.49 0.204-1.675 0.085c-0.181-0.116-0.331-0.383-0.351 0.301 0 0-0.636 0.197-0.81-0.063-0.177-0.256-0.034 0.224-0.596 0.237-0.556 0.015-0.629-0.321-0.436 0.364 0.195 0.685-0.626-0.643-0.606 0.153 0.019 0.802-0.055 1.712 0.385 1.219 0 0 0.246-0.211 0.095 0.274-0.15 0.484 0.178 0.498 0.295 0.408 0.117-0.088 0.27-0.175 0.347 0.151 0.079 0.328 0.223 0.089 0.531 0.014 0.311-0.074 0.779-0.224 0.846-0.384 0.066-0.163 0.167-0.047 0.44-0.041 0.274 0.008 1.039 0.221 0.696-0.247-0.346-0.468-0.207-0.094-0.458-0.312-0.255-0.216 0.085-0.36 0.524-0.319 0.442 0.041 0.104 0.537 0.161 0.636 0.057 0.102 0.314 0.16 0.856-0.064 0.537-0.222 0.201-0.041 0.218 0.169 0.015 0.208 0.278-0.307 0.319-0.391 0.044-0.083 2.075-0.445 2.324-0.279 0.245 0.164-0.263 0.142 0.353 0.342 0 0 0.021 0.447 0.601 0.082 0.581-0.367 0.564-0.242 0.75-0.087 0.18 0.153-0.106-0.585-0.213-0.599-0.112-0.012 0.202-0.183 0.303 0.207 0.106 0.388 0.071 0.341 0.45 0.339 0.38-0.004 0.88-0.341 1.551 0.01 0.669 0.35 0.255-0.447 0.025-0.556-0.232-0.109-0.071-0.401 0.508-0.351 0.581 0.047 0.409-0.497 1.455-0.252 1.049 0.243 0.194 0.177 0.027 0.235-0.166 0.057-0.511 0.21-0.482 0.47 0.024 0.261-1.086-0.446-0.987 0.078 0.095 0.525 0.043 0.706 0.506 0.509 0.46-0.192 0.526 0.552-0.512 0.559-1.036 0.004-0.96-0.102-1.176 0.099-0.222 0.197-1.062 0.693-1.82 0.324-0.761-0.37-0.944-0.658-0.88-0.047 0.065 0.614-0.552-0.214-0.609-0.279-0.063-0.064 0.109 0.426-0.214 0.151-0.324-0.275-0.419-0.326-0.305 0.229 0.111 0.554-0.21-0.002-0.314-0.114-0.103-0.108-0.113-0.021-0.061 1.232 0.053 1.254-0.251-0.152-0.549 0.281-0.299 0.431-0.005 0.238-0.354 0.175-0.36-0.066-0.519-0.024-0.232 0.31 0.287 0.335-0.601-0.334-0.27 0.342 0.337 0.673 0.168 1.584 0.529 1.082 0.361-0.505-0.333 0.843 0.507 0.579 0.84-0.265-0.496 0.482 0.6 0.08 0 0 0.014-0.385 0.415-0.358 0.406 0.026 0.845 0.171 0.141-0.518 0 0-0.034-0.393 0.213-0.238 0.248 0.158 0.093 0.597 0.318 0.617 0.225 0.016 0.704-0.306 1.084-0.161 0.374 0.147 1.357-0.115 1.391-0.26 0.032-0.15-0.822-0.576-0.452-0.548 0.367 0.027 0.916-0.136 0.743 0.527-0.171 0.664-0.04 0.063-0.87 0.733-0.152 0.123-0.291 0.254-0.426 0.385h-22.209v-16.413h0.006c0.553-0.017-0.2-0.62 0.26-0.662 0.459-0.043 0.632-0.958 0.539-1.584-0.089-0.627 0.432-1.317 0.458-1.52 0.028-0.202-0.127-0.738-0.511-0.232-0.389 0.509-0.155-0.323-0.044-0.5 0.112-0.177 0.235 0.029 0.489 0.201 0.256 0.174 0.345-0.14 0.778-1.258 0.432-1.117 2.226-3.252 2.229-3.48 0.003-0.23 0.216-0.339 0.092-0.469-0.126-0.131-0.314 0.221-0.621 0.38-0.303 0.158-0.215-0.091-0.215-0.091-0.275-0.8 2.157-3.094 2.491-3.159 0.326-0.061 0.336-0.386 1.026-0.784 0.693-0.392 0.571-0.818 0.955-0.731 0.385 0.084-0.284 0.451-0.731 0.879-0.442 0.423-0.588 0.605-0.701 0.771-0.114 0.163 0.486 0.221 0.173 0.238-0.311 0.024-1.007 0.677-1.717 1.349-0.711 0.671-0.416 0.6-0.243 0.775 0.171 0.174 0.645 0.802 0.683 0.179 0.038-0.62 0.906-1.474 1.598-1.828 0.69-0.356 0.103-0.492 0.895-1.13 0.339-0.273 0.665-0.556 0.949-0.827-0.008 0.263 0.014 0.522 0.024 0.67 0.04 0.455 0.223 0.662-0.448 0.429-0.674-0.228-0.705 0-0.705 0-0.271 0.721 0.045 1.281 0.354 2.057 0.306 0.777 0.45 0.703 0.503 0.507 0.05-0.2 0.339-0.369 0.897-0.334 0.559 0.037 0.737-0.165 0.307-0.611-0.431-0.446 0.207-0.121 0.207-0.121 0.209 0.812 0.128 0.478 1.552 0.291 1.421-0.191 0.962-0.442 0.754-0.782-0.216-0.341 0.47-0.013 0.47-0.013 0.718 0.847 0.035 0.742-0.12 0.699-0.151-0.042-0.142 0.057-0.238 0.364-0.094 0.304-0.771 0.761-1.076 0.835-0.302 0.076-0.779 0.601-0.889 0.895-0.11 0.296-0.573 0.675-0.753 0.386-0.175-0.292-0.197-0.146-0.197-0.146-0.269 0.424-0.316 0.112-1.158 0.293-0.848 0.177-0.412 0.331-0.412 0.331 2.512 0.048 3.321-0.835 3.321-0.835 1.17-0.344 0.29-0.435 0.893-0.694 0.603-0.263 1.027-0.315 0.946-0.642-0.081-0.331 0.547-0.304 0.547-0.304 2.422-0.483-0.281-0.545 0.963-1 1.243-0.451-0.396 0.291 0.457 0.295 0.853 0.011 0.691 0.14-0.016 0.531-0.704 0.395-0.921 0.808-1.665 0.91-0.737 0.104-1.874 0.992-2.875 1.606-1.001 0.619-0.253-0.27-1.753 0.417-1.499 0.684-1.044 0.769-0.027 0.799 1.007 0.029 3.024-0.928 4.446-1.744 1.417-0.812 0.868-0.295-0.137 0.419-1.002 0.716-2.4 1.615-3.726 2.256-1.326 0.64-1.232 0.559-1.456 0.621-0.229 0.061-0.101 0.156-0.101 0.156-0.043 0.718 0.228 0.406 0.675 0.298 0.451-0.112 0.401-0.006 0.252 0.112-0.153 0.117-0.203 0.267 0.025 0.416 0.227 0.151 0.87-0.82 1.197-1.174 0.335-0.352 0.818-0.396 1.463-0.6 0.651-0.202 0.739-0.449 0.386-0.322-0.352 0.132 0.214-0.357 0.094-0.419-0.124-0.062-0.138 0.214-0.68 0.327-0.546 0.112 1.15-1.039 1.379-1.108 0.234-0.07-0.234 0.176-0.276 0.333-0.04 0.155 0.292-0.206 0.682-0.339 0.397-0.13-0.192 0.25-0.531 0.451-0.346 0.202-0.207 0.685 0.194 0.153 0.399-0.529 1.879-1.13 1.879-1.13s0.202 0.382 0.238 0.128c0.036-0.258 0.915-0.681 1.471-0.898 0.552-0.218 0.131-0.534 0.131-0.534-0.42-0.376 0.353-0.34 0.353-0.34 0.428-0.738 2.538-0.923 3.034-1.088 0.501-0.171 1.129 0.124 0.684-0.327-0.442-0.445 0.256-0.382 0.899-0.673 0.637-0.288 1.154 0.095 0.675-0.369-0.482-0.469 0.12-0.407 0.12-0.407 0.474-1.134-2.096-1.667-2.096-1.667s-0.627 0.801-1.114 0.997c-0.49 0.193 0.06 0.112 0.132 0.482 0.075 0.369-0.388 0.62-0.306 0.35 0.077-0.265-0.185-0.85-0.515-0.667-0.335 0.179-0.631 0.355-1.522 0.234-0.889-0.118-1.456 0.234-1.677 0.507-0.224 0.276-0.521 0.236-0.779 0.232-0.25-0.005-0.522-0.318-0.509 0.111 0.016 0.428-0.261-0.029-0.261-0.029-0.558-0.407 2.211-0.916 3.194-1.018 0.983-0.103 2.318-0.892 2.027-0.963-0.292-0.068-0.667 0.28-0.591-0.18 0.075-0.457 0.084-0.205-0.438-0.12-0.522 0.083-0.375 0.505-1.107 0.382-0.735-0.123-0.674 0.251-1.391 0.3-0.715 0.053-1.013-0.031-0.341-0.215 0.671-0.186 0.506-0.001 1.831-0.792 1.322-0.79 0.939-0.181 1.617-0.457 0.681-0.277 0.239-0.696 0.044-0.783-0.191-0.088-0.265 0.18-0.389-0.311-0.123-0.491-0.517-0.16-0.904 0.407-0.389 0.563-0.761 0.588-1.437 0.437-0.678-0.149-0.482 0.242-0.482 0.242 0.508 0.593-0.097 0.101-0.532 0.463-0.438 0.36-0.946 0.289-1.024 0.281-0.077-0.006-0.342-0.223-0.571 0.122-0.228 0.352-1.574 0.355-2.012 0.029-0.44-0.326-0.436-0.272-0.439-0.128-0.007 0.147 0.311 0.538-0.753-0.015-0.084-0.044-0.148-0.053-0.218-0.074 0.013-0.029 0.046-0.068 0.052-0.094 0.094-0.368 1.369-1.038 1.675-1.245 0.307-0.21 0.525 0.028 0.525 0.028 1.135-0.112 1.89-0.503 1.866-0.639-0.02-0.136-1.075 0.401-1.222 0.28-0.145-0.122 0.669-0.375 1.219-0.469 0.551-0.101 0.235-0.203 0.235-0.203-1.953-0.415-5.752 2.871-5.583 2.378 0.167-0.494 4.099-2.414 4.414-2.866 0.313-0.454 1.515-0.48 1.056-0.765-0.455-0.287-2.703 1.314-4.782 2.158-2.073 0.844-3.696 3.065-3.826 2.782-0.137-0.289 0.537-1.718 4.368-3.833 1.334-0.738 2.209-1.351 2.809-1.834 0.98 0.12 1.772 0.384 2.004 0.832 0.564 1.085 0.849 0.805 0.89 0.587 0.043-0.221 0.149-0.114 0.322 0.214 0.168 0.322 0.214 0.007 0.214 0.007s0.025-0.056 0.324 0.119c0.295 0.178-0.467 0.058-0.535 0.308-0.07 0.248 0.779 0.584 1.059 0.344 0.28-0.239-0.355-0.382 0.029-0.504 0.382-0.115 1.759 0.2 2.45 0.66 0.687 0.458 1.764 1.098 2.211 1.642 0.445 0.553 0.772 0.414 0.694 0.38-0.081-0.037-0.427-0.171 0.297-0.093 0.728 0.074 0.772 0.609 0.728 0.794-0.044 0.188 0.038-0.227-0.22 0-0.255 0.226 0.171 0.574 0.236 0.411 0.059-0.165-0.019-0.146 0.433-0.193 0.453-0.049 1.466 0.933 2.13 1.593 0.661 0.665 0.976 0.559 0.878 0.804-0.095 0.241-0.016 0.308-0.016 0.308 1.009 0.726 2.004 2.038 2.511 2.641 0.51 0.598-0.053-0.674 0.743 0 0.798 0.676 2.065 3.19 2.382 3.761 0.317 0.563 1.04 1.61 1.068 2.274 0.021 0.664 0.239 0.55 0.431 0.489 0.184-0.063 0.598 0.943 0.563 1.119-0.03 0.175-0.075 0.475 0.253 0.526 0.326 0.052 0.058 0.084 0.366 0.865 0.305 0.783-0.177 0.57 0.473 0.339 0.653-0.231 0.319 0.763 0.319 0.763 0.259 0.449 1.651-0.115 1.589-0.324-0.055-0.208-0.607-0.511-0.222-0.487 0.379 0.027 0.675-0.358 0.588-0.328-0.091 0.031-0.527-0.531-0.234-0.8s-0.212-1.507-0.69-1.719c-0.479-0.213-0.604-1.426-0.836-1.827-0.225-0.398-0.455 0.083-0.639 0.198-0.18 0.113 0.29 0.563 0.151 0.674-0.139 0.112-1.11-0.694-0.724-1.035 0.38-0.343 0.722-0.242 0.013-1.363-0.711-1.122-2.286-3.922-2.608-4.337-0.321-0.414-0.706-1.092-0.607-0.803 0.096 0.281 0.017 0.195-0.347 0.206-0.368 0.011 0.185 0.336 0.272 0.569 0.087 0.229-0.304 0.484-0.338 0.174-0.032-0.309-1.776-1.926-2.511-2.547-0.736-0.62-2.475-2.689-2.798-2.957-0.329-0.27-0.387-0.274-0.242-0.361 0.142-0.084 1.051 0.703 1.451 1.147 0.4 0.446 0.75 0.59 1.117 0.429 0.371-0.156 0.937 1.133 1.651 2.199 0.711 1.064 0.973 0.458 1.189 0.243 0.216-0.219-0.129-0.436-0.375-0.557-0.245-0.118-1.794-2.116-1.957-2.214-0.164-0.099-0.203 0.112-0.28 0.038-0.075-0.07 0.236-0.13 0.187-0.283-0.056-0.156-0.655-0.623-0.562-0.399 0.095 0.224-0.238 0.254-0.749-0.42-0.509-0.68-2.428-1.454-2.891-1.813-0.461-0.358-0.074 0.323-0.585-0.062-0.51-0.383-0.964-0.963-1.402-1.038-0.441-0.072-0.529-0.527-0.514-0.691 0.016-0.167-0.005-0.363-0.363-0.422-0.361-0.053-1.18-0.634-1.282-0.691-0.106-0.049-0.434 0.299-0.267 0.401 0.163 0.103 1.234 0.956 1.301 1.098 0.065 0.145 0.168 0.244 0.615 0.323 0.446 0.084 1.894 1.299 2.282 1.714 0.396 0.415-0.351-0.115-0.734-0.361-0.385-0.246-2.847-2.073-3.185-2.269-0.341-0.194-0.077 0.101-0.711-0.026-0.637-0.122 0.138-0.429-0.246-0.522-0.382-0.093-0.633 0.329-0.69 0.436-0.056 0.112 2.889 2.325 4.05 2.948 1.163 0.621 4.051 3.314 4.314 3.587 0.263 0.278 0.62 0.811 0.2 0.423-0.411-0.388 0.094-0.078-4.179-3.094-4.274-3.014-5.448-2.367-5.55-3.242-0.1-0.871 4.373-2.094 4.851-2.182 0 0 0.312-0.09 0.521-0.127 0.206-0.039 0.134-0.004 0.327-0.192 0.193-0.191 0.21-0.217 0.006-0.228-0.205-0.006-0.546-0.024-0.52-0.274 0.026-0.255 3.026-0.76 3.135-0.658 0.106 0.102 1.562 0.012 1.963 0.102 0.406 0.093-0.06 0.27-0.237 0.16-0.18-0.111-1.08-0.01-1.176 0.096-0.092 0.106-0.261 0.183-0.577 0.306-0.309 0.12-0.868-0.15-1.557-0.076-0.686 0.073-0.268 0.582-0.221 0.75 0.046 0.163 0.351-0.047 0.351-0.047 0.012-0.006 0.021-0.014 0.03-0.019 0.401-0.212 0.901-0.045 1.533-0.102 0.649-0.054 1.197-0.318 1.197-0.318 0.924 0.038-0.289-0.366 2.056-0.183 2.343 0.18 3.172 0.69 3.469 0.913 0.29 0.222 0.436 0.029 0.436 0.029-1.806-1.922-5.571-1.046-4.491-1.576 1.088-0.526 5.556 1.444 5.454 1.301-0.107-0.145-1.037-0.278-0.39-0.282 0.645-0.011 0.645 0.315 0.551 0.063-0.099-0.254-0.827-0.524-2.703-1.36-1.869-0.84-5.252-0.5-5.488-0.45-0.238 0.05-0.218-0.092-0.218-0.092s-0.2-0.369 2.064-0.313c2.261 0.062 4.068 0.385 5.906 0.902 1.835 0.518 1.42 0.939 1.835 0.705 0.41-0.238-0.102-0.451-0.43-0.596-0.323-0.146-0.732-0.445-0.491-0.425 0.242 0.021 0.647 0.079 0.572-0.19-0.071-0.266-1.737-0.246-2.441-0.315-0.703-0.073-2.42-0.62-2.764-0.709-0.342-0.085 0.045 0.383 0.045 0.383-1.066 0.174-1.088-0.237-1.899-0.321-0.809-0.077-2.175 0.187-2.417 0.171-0.24-0.017 0.029-0.248-0.904 0.049-0.931 0.298-1.747 0.191-2.191 0.37-0.444 0.175 0.056 0.276-0.126 0.432-0.18 0.155-0.218 0.43-0.649 0.224-0.426-0.207-4.21 1.387-4.21 1.387-0.154 0.06-0.042 0.174-0.439 0.14-0.401-0.03-0.205 0.082-0.115 0.29 0.088 0.212-0.361 0.181-0.771 0.445-0.408 0.267-0.429-0.147-0.421 0.262 0.006 0.407-0.327 0.3-0.602 0.129-0.273-0.171-0.355 0.141-0.244 0.292 0.109 0.152-0.165 0.057-0.165 0.057-0.222-0.049-0.177-0.553 0.368-0.547 0.539 0.006 0.546-0.17 0.459-0.175-0.08-0.004-0.17-0.133-0.036-0.184 0.129-0.053-0.199-0.509-0.813-0.204-0.552 0.279-0.951 0.193-1.029 0.174 0.076-0.065 0.135-0.087 0.2-0.063 0.35 0.12 0.51-0.433 0.244-0.619-0.073-0.051-0.508 0.154-1.1 0.477-3.943-1.158-6.577 0.139-7.008 0.579-0.449 0.468-0.922 0.415-1.088 0.533-0.166 0.115-0.022 0.095-0.356 0.002-0.331-0.089-1.2 0.512-1.281 0.567-0.08 0.057-0.437 0.308-0.146 0.263 0.291-0.048 1.428-0.391 1.899-0.697 0.467-0.306 1.235-0.324 1.341-0.363 0.105-0.041 0.694-0.234 0.734-0.384 0.048-0.152 1.324-0.255 1.324-0.255 0.3-0.045 0.109-0.352 0.2-0.291 0.094 0.062 0.332-0.045 0.332-0.045 0.8-0.338 1.789 0.166 2.222 0.171 0.432 0.001 0.259 0.088 0.273 0.23 0.015 0.135-0.019 0.038-0.019 0.038-1.346-0.694-7.396 1.237-7.398 1.469 0 0.049 0.008 0.065 0.016 0.076-0.019-0.011-0.069-0.009-0.218 0.091-0.358 0.243-0.998 0.528-1.004 0.66-0.005 0.128 0.5-0.132 0.865-0.337 0.359-0.206-0.276 0.342-0.507 0.529-0.228 0.189-0.306 0.419-0.33 0.506-0.022 0.09 0.643-0.165 0.563-0.347-0.084-0.184 0.33-0.538 0.33-0.538 2.755-1.172 4.199-1.373 4.816-1.497 0.622-0.123 0.434 0.048 0.434 0.048-2.708 0.401-5.992 2.726-5.992 2.726-0.403 0.099-0.304 0.704 0.136 0.313 0.437-0.391 0.863-0.343 0.624-0.258-0.01 0.007-0.025 0.012-0.037 0.018-0.197 0.089-0.171 0.214-0.171 0.214 0.18 0.403 0.529-0.236 0.529-0.236 1.026-1.275 0.729-0.75 1.208-0.946 0.483-0.19 1.282-0.357 1.222-0.52-0.062-0.16-0.179 0.103-0.201-0.05-0.019-0.152 1.767-0.56 1.767-0.56 0.711-0.211 1.676-0.34 2.643-0.367-1.157 0.715-2.187 1.394-2.287 1.509-0.233 0.268 1.407-0.562 1.34-0.263-0.066 0.295-2.543 1.707-2.405 1.513 0.144-0.192 1.578-0.932-0.009-0.255-1.593 0.681-2.219 2.63-2.833 2.615-0.614-0.014-1.513 1.683-1.808 1.996-0.295 0.312-0.788 0.868-0.674 1.068 0.115 0.204 1.541-0.903 0.106 0.438-0.695 0.653-1.469 1.932-2.093 3.069v-18.027h41.438v41.438h-12.447z" fill=#003862 /></g><g transform="matrix(1.448 0 0 -1.448 306.01 1062.8)"><path d="m0 0c-0.334 0.401-1.045 1.07-1.682 1.138-0.843 0.094-1.219 0.776-1.573 0.71-0.349-0.065-0.539-0.32-1 0.005-0.467 0.321-1.037-0.129-0.481-0.131 0.557-0.003-0.001-0.289 1.329-0.41 1.086-0.1 1.613-0.72 2.223-1.312h1.184z" fill=#003862 /></g><g transform="matrix(1.448 0 0 -1.448 314.12 1062.8)"><path d="m0 0c-0.049 0.457-0.165 1.003-0.402 1.41-0.458 0.793-0.319 1.464 0.387 1.776 0 0 0.271 0.04 0.312-0.295 0.04-0.335 0.571 0.874 1.714 0.889 0 0 0.35 0.188 0.132 0.233-0.214 0.042 0.637 0.342 0.255-0.119-0.379-0.462 0.478-0.047 0.678 0.14 0.198 0.185 0.642-0.202 0.675-0.313 0.029-0.109 0.183 0.266 0.014 0.404-0.163 0.141 0.967 0.592-0.036 0.387-1.001-0.207-0.587 0.038-1.419-0.125-0.827-0.164-2.197-0.499-0.898 0.059 1.298 0.556 1.493 0.553 1.752 0.75 0.261 0.201 1.359 0.442-0.104 0.447-1.461 0.002-0.544-0.546-3.498-1.588 0 0-0.727 0.004 0.312 0.428 0 0 0.28 0.23 0.457 0.555 0.176 0.327 0.139 0.044 0.265-0.06 0.132-0.102 0.371 0.109 0.618 0.216 0.239 0.104 0.152 0.035 0.159-0.049 0.008-0.082 0.479 0.217 0.564 0.326 0.082 0.108 1.173 0.702 1.353 0.641 0.179-0.064 0.213 0.387-0.954-0.106 0 0-0.196-0.074-0.208-0.146 0 0 0.003-0.038 0.039-0.049 0.035-0.009-0.132-0.255-0.396-0.168-0.26 0.085-0.269-0.071-0.673 0.04-0.407 0.112-0.895-0.15-1.087-0.336-0.192-0.179-0.359-0.34-0.487-0.347-0.129-0.006-0.027-0.484-0.354-0.428-0.328 0.057-0.204 0.27-0.204 0.27s-0.443 1.636-0.738 2.159c-0.231 0.404-0.016 0.294 0.147 0.133-0.233 0.326-0.698 1.055-0.654 1.364 0.057 0.433-0.086 1.304-0.469 1.075 0 0-0.142 0-0.013-0.089 0.131-0.089 0.125-0.265-0.009-0.131-0.134 0.131-0.485 0.61-0.646 0.344 0 0-0.226-0.055-0.038-0.184 0.192-0.127 0.292-0.183 0.537-0.757 0 0 0.052-0.135 0.2-0.244 0.147-0.113 0.153-0.227 0.152-0.354-0.005-0.124 0.181-0.504 0.295-0.546 0.116-0.044 0.607-1.595 0.567-1.86-0.041-0.261-0.011-0.799 0.102-1.018 0.106-0.22-0.041-0.222-0.176 0.239-0.133 0.461-0.197 0.777-0.504 1.381-0.306 0.601-0.259 1.168-0.828 1.549-0.573 0.38-0.461 0.778-0.862 0.668 0 0-0.104-0.015 0.042-0.152 0.151-0.139 0.252-0.003 0.428-0.421 0 0 0.062-0.294-0.11-0.304-0.173-0.009 0.373-0.505 0.484-0.756 0.112-0.253 0.463-0.801 0.402-0.991-0.063-0.189-0.411 0.464-0.655 1.002-0.244 0.537-0.466 0.878-0.862 0.925 0 0-0.038-0.09 0.072-0.142 0.11-0.05 0.138-0.09 0.141-0.27 0-0.177-0.055-0.41 0.17-0.477 0.223-0.069 0.21 0.067 0.286 0.035 0.075-0.033 0.36-0.414 0.259-0.919-0.1-0.505 0.035-1.332 0.112-1.51 0.084-0.179 0.45-0.765 0.351-0.965-0.098-0.199-0.03-0.292 0.276-0.186 0.309 0.105 0.501-0.026 0.138 0.676-0.364 0.7-0.488 0.221-0.245 0.515 0.252 0.294-0.063 0.745-0.123 0.955-0.065 0.209 0.119 0.166 0.169 0.04 0.049-0.124 0.199-0.816 0.379-0.892 0.184-0.078 0.325-0.901 0.199-1.213-0.088-0.226-0.013-0.345 0.037-0.397-0.04 0.03-0.124 0.058-0.276-0.041-0.236-0.15-0.93-0.565-0.579-0.888 0.352-0.323 0.254-0.347 0.194-0.347-0.054 0-0.339 0.207 0-0.199 0.341-0.402 0.551-0.47 0.609-0.579 0.061-0.112-0.072 0.182 0.065 0.25 0.142 0.072 0.252-0.484 0.149-0.566-0.046-0.038-0.071-0.243-0.049-0.47-0.013 0.006-0.049 0.021-0.058 0.025-0.275 0.115 0.07 0.238 0 0.474-0.072 0.236-1.209 0.636-1.289 0.698-0.081 0.061-0.125 0.042-0.051 0.131 0.073 0.091-0.407 0.501-0.467 0.328-0.057-0.176-0.206-0.148-0.206-0.148-0.344 0.102-1.968 1.286-2.236 1.307-0.265 0.019-0.774-0.019-0.718 0.217 0.058 0.233 0.556-0.149 0.423 0.157-0.134 0.305-1.093 0.559-1.524 0.639-0.435 0.08-0.562 0.253-0.562 0.253-0.458 0.671-1.132 1.266-1.132 1.266l0.039 0.012c-0.661-0.133 0.1-0.354-0.035-0.643-0.138-0.288-0.451 0.152-0.451 0.152-1.483-0.551-0.285-0.305 1.616-1.492 1.901-1.188 1.544-0.2 3.288-1.857 1.746-1.657 0.127-0.315-0.878-0.051-1.008 0.262-1.242 0.86-2.15 1.013-0.908 0.154-3.161 0.806-1.977 0.121 1.184-0.684 1.688-1.103 2.9-1.42 0.648-0.172 1.997-0.835 3.047-1.466h4.329z" fill=#003862 /></g><g transform="matrix(1.448 0 0 -1.448 311.94 1052.7)"><path d="m0 0c-0.026 0.046-0.072 0.1-0.121 0.149 0.094-0.134 0.155-0.208 0.121-0.149" fill=#003862 /></g><g transform="matrix(1.448 0 0 -1.448 272.14 1096.7)"><path d="m0 0c-0.66 1.206-1.152 2.254-1.195 2.226-0.072-0.054-0.683 0.618-0.414 0.698 0.259 0.08 0.732 0.178 0.351 0.527-0.379 0.351-0.985 1.095-0.614 0.999 0.379-0.099 0.401-0.05 0.106 0.261s-0.778 1.687-0.393 1.501c0.383-0.182 0.358 0.255 0.187 0.6-0.174 0.347-0.869 0.214 0.557 0.551 1.336 0.313 0.938-0.346 0.882-0.432 0.025 0.027 0.128 0.078 0.533 0.067v-6.998z" fill=#003862 /></g></g></g><text font-size=39.999px transform="scale(1 .99998)" line-height=125% style=word-spacing:0px;letter-spacing:0px xml:space=preserve y=-71.98513 x=117.04676 font-family=sans-serif fill=#000000><tspan y=-71.98513 x=117.04676 /></text><g font-family=sans-serif transform="matrix(1.2402 0 0 1 48.17 17.315)"><text font-size=13.791px line-height=125% transform="scale(.89796 1.1136)" style=word-spacing:0px;letter-spacing:0px y=-0.54994416 x=2.8649783 xml:space=preserve><tspan y=-0.54994416 x=2.8649783>{{ title }}</tspan></text><text font-size=11.225px line-height=125% transform="scale(.89796 1.1136)" style=word-spacing:0px;letter-spacing:0px y=12.774043 x=3.1857841 xml:space=preserve><tspan y=12.774043 x=3.1857841>{{ legendInfo.author }}</tspan></text><text font-size=8.9796px line-height=125% transform="scale(.89796 1.1136)" style=word-spacing:0px;letter-spacing:0px y=26.193958 x=3.4663973 xml:space=preserve><tspan y=26.193958 x=3.4663973>{{ legendInfo.date }}</tspan></text></g><g transform=translate(42,6)><line stroke-width=1.1136 style=mix-blend-mode:normal y2=42.074 font-size=12 x2=287.22 stroke=#000 stroke-miterlimit=10 y1=19.397 x1=287.22 /><text style=mix-blend-mode:normal font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=47.968887 x=262.36462 font-weight=bold fill=#000000>0</text><line stroke-width=1.1136 style=mix-blend-mode:normal y2=42.074 font-size=12 x2=322.38 stroke=#000 stroke-miterlimit=10 y1=19.397 x1=322.38 /><text style=mix-blend-mode:normal font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=47.968887 x=293.93243 font-weight=bold fill=#000000>1</text><line stroke-width=1.1136 style=mix-blend-mode:normal y2=42.074 font-size=12 x2=357.54 stroke=#000 stroke-miterlimit=10 y1=19.397 x1=357.54 /><text style=mix-blend-mode:normal font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=47.968887 x=325.50021 font-weight=bold fill=#000000>2</text><line stroke-width=1.1136 style=mix-blend-mode:normal y2=42.074 font-size=12 x2=392.68 stroke=#000 stroke-miterlimit=10 y1=19.397 x1=392.68 /><text style=mix-blend-mode:normal font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=47.968887 x=357.06805 font-weight=bold fill=#000000>3</text><line stroke-width=1.1136 style=mix-blend-mode:normal y2=42.074 font-size=12 x2=427.84 stroke=#000 stroke-miterlimit=10 y1=19.397 x1=427.84 /><text style=mix-blend-mode:normal;text-anchor:end font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=47.968887 x=403.07394 font-weight=bold fill=#000000>4cm</text><line stroke-width=1.114 style=mix-blend-mode:normal y2=25.287 font-size=12 x2=286.66 stroke=#000 stroke-miterlimit=10 y1=25.287 x1=428.4 /><text style=mix-blend-mode:normal;text-anchor:end font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=17.034184 x=403.25516 font-weight=bold fill=#000000>{{ legendInfo.km }}km</text><g style=mix-blend-mode:normal mix-blend-mode=normal font-size=12 transform="matrix(1.2402 0 0 1 287.22 25.397)" stroke=#000 stroke-miterlimit=10><line x2=14.173 x1=14.173 y2=11.339 /><line x2=42.52 x1=42.52 y2=11.339 /><line x2=70.866 x1=70.866 y2=11.339 /><line x2=99.213 x1=99.213 y2=11.339 /></g><text style=mix-blend-mode:normal;text-anchor:end font-family=monospace transform="scale(1.1136 .89795)" font-size=7.7955px y=17.034184 x=322.17062 font-weight=bold fill=#000000>{{ legendInfo.scale }}</text></g><g stroke=#000 transform="matrix(.086033 0 0 .086031 264.26 4.706)"><g stroke=#000 transform="matrix(.4431 0 0 .4431 253.34 54.222)"><path d="m373.75 91.496c-0.95-1.132-74.87 153.23-164.19 343.02-160.8 341.68-162.27 345.16-156.49 350.27 3.203 2.83 6.954 4.79 8.319 4.34 1.365-0.46 71.171-73.88 155.14-163.1 83.97-89.22 153.66-162.83 154.87-163.56 1.2-0.72 71.42 72.34 156.04 162.29s155.21 163.82 156.95 164.19 5.57-1.19 8.5-3.44c5.04-3.86-3.75-23.46-156.04-348-88.77-189.18-162.15-344.88-163.1-346.01zm-2.72 42.694c1.4-1.53 2.45 63.91 2.45 148.36v151.07l-142.3 151.34c-124.61 132.46-143.8 152.86-145.1 153.51 0.143-0.35 1.009-1.57 1.361-2.26 0.81-1.59 64.409-137.07 141.3-301.05 76.89-163.99 140.93-299.45 142.29-300.97zm-99.77 642v244.81h32.11v-204.82l108.55 204.82h44.6v-244.81h-32.11v204.8l-108.56-204.8h-44.59z" stroke=#000 /></g></g></svg>';
},{}],12:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js"),_info=require("./info.vue"),_info2=_interopRequireDefault(_info);exports.default={store:["defaultWMTSSrc","defaultWFSSrc","gokartService","fixedScales","resolutions","matrixSets","dpmm","view"],components:{gkInfo:_info2.default},data:function(){return{scale:0,graticule:new _vendor.ol.LabelGraticule,dragPanInter:new _vendor.ol.interaction.DragPan({condition:function(mapBrowserEvent){return(!mapBrowserEvent.pointerEvent||1!==mapBrowserEvent.pointerEvent.button)&&_vendor.ol.events.condition.noModifierKeys(mapBrowserEvent)}}),doubleClickZoomInter:new _vendor.ol.interaction.DoubleClickZoom,keyboardPanInter:new _vendor.ol.interaction.KeyboardPan,keyboardZoomInter:new _vendor.ol.interaction.KeyboardZoom,middleDragPanInter:new _vendor.ol.interaction.DragPan({condition:function(mapBrowserEvent){return!(!mapBrowserEvent.pointerEvent||1!==mapBrowserEvent.pointerEvent.button)&&(mapBrowserEvent.preventDefault(),!0)}})}},computed:{scaleString:function(){return this.getScaleString(this.scale)},width:{cache:!1,get:function(){return this.$el?this.$el.clientWidth:0}},height:{cache:!1,get:function(){return this.$el?this.$el.clientHeight:0}}},methods:{animatePan:function(location){var pan=_vendor.ol.animation.pan({source:this.getCenter()});this.olmap.beforeRender(pan),this.olmap.getView().setCenter(location)},animateZoom:function(resolution){var zoom=_vendor.ol.animation.zoom({resolution:this.olmap.getView().getResolution()});this.olmap.beforeRender(zoom),this.olmap.getView().setResolution(resolution)},setScale:function(scale){for(;Math.abs(this.getScale()-scale)>.001;)this.olmap.getView().setResolution(this.olmap.getView().getResolution()*scale/this.getScale());this.scale=scale,this.$els.scale.selectedIndex=0},getScale:function(){var size=this.olmap.getSize(),center=this.getCenter(),extent=this.olmap.getView().calculateExtent(size),distance=2*this.$root.wgs84Sphere.haversineDistance([extent[0],center[1]],center);return distance*this.dpmm/size[0]},getFixedScale:function(){var scale=this.getScale(),closest=null;return _vendor.$.each(this.fixedScales,function(){(null===closest||Math.abs(this-scale)<Math.abs(closest-scale))&&(closest=this)}),closest},getScaleString:function(scale){return Math.round(100*scale)/100<1?"1:"+(Math.round(1e5*scale)/100).toLocaleString():Math.round(100*scale)/100>=1e3?"1:"+(Math.round(scale/10)/100).toLocaleString()+"M":"1:"+(Math.round(100*scale)/100).toLocaleString()+"K"},getDMS:function(coords){return _vendor.ol.coordinate.toStringHDMS(coords,1)},getMGA:function(coords){var mga=this.getMGARaw(coords);return"MGA "+mga.mgaZone+" "+Math.round(mga.mgaEast)+"mE "+Math.round(mga.mgaNorth)+"mN"},getMGARaw:function(coords){var results={};if(coords[0]>=108&&coords[0]<114)results.mgaZone=49;else if(coords[0]>=114&&coords[0]<120)results.mgaZone=50;else if(coords[0]>=120&&coords[0]<126)results.mgaZone=51;else if(coords[0]>=126&&coords[0]<132)results.mgaZone=52;else if(coords[0]>=132&&coords[0]<138)results.mgaZone=53;else if(coords[0]>=138&&coords[0]<144)results.mgaZone=54;else if(coords[0]>=144&&coords[0]<150)results.mgaZone=55;else{if(!(coords[0]>=150&&coords[0]<156))return null;results.mgaZone=56}var newCoords=(0,_vendor.proj4)("EPSG:4326","EPSG:283"+results.mgaZone).forward(coords);return results.mgaEast=newCoords[0],results.mgaNorth=newCoords[1],results},parseDMSString:function(dmsStr){var dmsRegex=/^\s*(-)?(\d+(?:\.\d+)?)[°º:d\s]?\s*(?:(\d+(?:\.\d+)?)['’‘′:m]\s*(?:(\d{1,2}(?:\.\d+)?)(?:"|″|’’|''|s)?)?)?\s*([NSEW])?[,:\s]+(-)?(\d+(?:\.\d+)?)[°º:d\s]?\s?(?:(\d+(?:\.\d+)?)['’‘′:m]\s*(?:(\d{1,2}(?:\.\d+)?)(?:"|″|’’|''|s)?)?)?\s*([NSEW])?$/gim,groups=dmsRegex.exec(dmsStr);if(!groups)return null;var dmsToDecimal=function(sign,deg,min,sec,dir){var sg=sign?-1:1;sg*="wWsS".indexOf(dir)>=0?-1:1;var d=Number(deg),m=min?Number(min):0,s=sec?Number(sec):0;return d>=0&&d<=180&&m>=0&&m<=60&&s>=0&&s<=60?sg*(d+m/60+s/3600):null},coords=[dmsToDecimal(groups[1],groups[2],groups[3],groups[4],groups[5]),dmsToDecimal(groups[6],groups[7],groups[8],groups[9],groups[10])];if(!coords[0]||!coords[1])return null;if(groups[5]&&groups[10]){if("nNsS".indexOf(groups[5])>=0&&"nNsS".indexOf(groups[10])>=0)return null;if("wWeE".indexOf(groups[5])>=0&&"wWeE".indexOf(groups[10])>=0)return null;"nNsS".indexOf(groups[5])>=0&&"wWeE".indexOf(groups[10])>=0&&(coords=coords.reverse())}else groups[5]&&"nNsS".indexOf(groups[5])>=0?coords=coords.reverse():groups[10]&&"wWeE".indexOf(groups[10])>=0&&(coords=coords.reverse());return coords},parseMGAString:function(mgaStr){var mgaRegex=/MGA\s*(49|50|51|52|53|54|55|56)\s*(\d{3,7})\s*[mM]{0,1}\s*([nNeE]{0,1})\s*,*\s*(\d{4,7})\s*[mM]{0,1}\s*([nNeE]{0,1})/gi,groups=mgaRegex.exec(mgaStr);if(!groups)return null;var results={mgaZone:parseInt(groups[1]),mgaEast:groups[2],mgaNorth:groups[4]};if("E"===groups[5]&&"N"===groups[3]&&(results.mgaEast=groups[4],results.mgaNorth=groups[2]),3===results.mgaEast.length&&4===results.mgaNorth.length)results.mgaEast=results.mgaEast+"000",results.mgaNorth=results.mgaNorth+"000";else if(6!==results.mgaEast.length||7!==results.mgaNorth.length)return null;results.mgaEast=parseInt(results.mgaEast),results.mgaNorth=parseInt(results.mgaNorth);var coords=(0,_vendor.proj4)("EPSG:283"+groups[1],"EPSG:4326").forward([results.mgaEast,results.mgaNorth]);return results.coords=coords,results},parseFDString:function(fdStr){var fdRegex=/FD\s*([a-zA-Z]{2})\s*([0-9]{1,5})/gi,groups=fdRegex.exec(fdStr);if(!groups)return null;var results={fdNorth:groups[1],fdEast:groups[2]};return results},queryFD:function(fdStr,callback){_vendor.$.ajax({url:this.defaultWFSSrc+"?"+_vendor.$.param({version:"1.1.0",service:"WFS",request:"GetFeature",outputFormat:"application/json",srsname:"EPSG:4326",typename:"cddp:fd_grid_points_mapping",cql_filter:"(fdgrid = '"+fdStr+"')"}),dataType:"json",xhrFields:{withCredentials:!0},success:function(data,status,xhr){data.features.length&&callback(data.features[0].geometry.coordinates,"FD "+fdStr)}})},getCenter:function(){return this.olmap.getView().getCenter()},queryGeocode:function(geoStr,callback){var center=this.getCenter();_vendor.$.ajax({url:"https://gokart.dpaw.wa.gov.au/mapbox/geocoding/v5/mapbox.places/"+geoStr+".json?"+_vendor.$.param({country:"au",proximity:""+center[0]+","+center[1]}),dataType:"json",xhrFields:{withCredentials:!0},success:function(data,status,xhr){var feature=data.features[0];callback(feature.center,feature.text)}})},tileLoaderHook:function(tileSource,tileLayer){var numLoadingTiles=0,badTiles=0,tileLoader=tileSource.getTileLoadFunction();return function(tile,src){0===numLoadingTiles&&(tileLayer.progress="loading",badTiles=0),numLoadingTiles++;var image=tile.getImage();image.crossOrigin="anonymous",image.onload=function(){numLoadingTiles--,0===numLoadingTiles&&(badTiles>0?tileLayer.progress="error":tileLayer.progress="idle")},image.onerror=function(){badTiles++,image.onload()},tileLoader(tile,src)}},createTimelineLayer:function(options){var vm=this;options.params=_vendor.$.extend({FORMAT:"image/jpeg",SRS:"EPSG:4326"},options.params||{});var tileSource=new _vendor.ol.source.TileWMS({params:options.params,tileGrid:new _vendor.ol.tilegrid.TileGrid({extent:[-180,-90,180,90],resolutions:this.resolutions,tileSize:[1024,1024]})}),tileLayer=new _vendor.ol.layer.Tile({opacity:options.opacity||1,source:tileSource});return tileLayer.progress="",tileSource.setTileLoadFunction(this.tileLoaderHook(tileSource,tileLayer)),tileLayer.on("propertychange",function(event){"timeIndex"===event.key&&tileSource.updateParams({layers:options.timeline[event.target.get(event.key)][1]})}),options.updateTimeline=function(){_vendor.$.getJSON(options.source,function(data){tileLayer.set("updated",(0,_vendor.moment)().toLocaleString()),tileSource.setUrls(data.servers),options.timeline=data.layers.reverse(),tileLayer.set("timeIndex",options.timeIndex||options.timeline.length-1),vm.$root.active.update()})},options.updateTimeline(),options.refresh&&(tileLayer.refresh=setInterval(function(){options.updateTimeline()},1e3*options.refresh)),tileLayer.set("name",options.name),tileLayer.set("id",options.id),tileLayer},createWFSLayer:function(options){var vm=this,url=this.defaultWFSSrc;options.params=_vendor.$.extend({version:"1.1.0",service:"WFS",request:"GetFeature",outputFormat:"application/json",srsname:"EPSG:4326",typename:options.id},options.params||{});var vectorSource=new _vendor.ol.source.Vector,vector=new _vendor.ol.layer.Vector({opacity:options.opacity||1,source:vectorSource,style:options.style});return vector.progress="",vectorSource.loadSource=function(onSuccess){options.cql_filter?options.params.cql_filter=options.cql_filter:options.params.cql_filter&&delete options.params.cql_filter,vector.progress="loading",_vendor.$.ajax({url:url+"?"+_vendor.$.param(options.params),success:function(response,stat,xhr){var features=vm.$root.geojson.readFeatures(response);vectorSource.clear(!0),vectorSource.addFeatures(features),vector.progress="idle",onSuccess&&onSuccess()},error:function(){vector.progress="error"},dataType:"json",xhrFields:{withCredentials:!0}})},options.onadd&&vectorSource.on("addfeature",function(event){options.onadd(event.feature)}),options.refresh&&(vector.set("updated",(0,_vendor.moment)().toLocaleString()),vectorSource.refresh=setInterval(function(){vector.set("updated",(0,_vendor.moment)().toLocaleString()),vectorSource.loadSource()},1e3*options.refresh)),vectorSource.loadSource(),vector.set("name",options.name),vector.set("id",options.id),vector},createAnnotations:function(layer){return this.$root.annotations.featureOverlay},createTileLayer:function(layer){layer.base&&(layer.format="image/jpeg"),layer=_vendor.$.extend({opacity:1,name:"Mapbox Outdoors",id:"dpaw:mapbox_outdoors",format:"image/png",tileSize:1024,style:"",projection:"EPSG:4326",wmts_url:this.defaultWMTSSrc},layer);var matrixSet=this.matrixSets[layer.projection][layer.tileSize],tileGrid=new _vendor.ol.tilegrid.WMTS({origin:_vendor.ol.extent.getTopLeft([-180,-90,180,90]),resolutions:this.resolutions,matrixIds:matrixSet.matrixIds,tileSize:layer.tileSize});tileGrid.origGetZForResolution=tileGrid.getZForResolution,tileGrid.getZForResolution=function(resolution,optDirection){return tileGrid.origGetZForResolution(1.4*resolution,-1)};var tileSource=new _vendor.ol.source.WMTS({url:layer.wmts_url,layer:layer.id,matrixSet:matrixSet.name,format:layer.format,style:layer.style,projection:layer.projection,wrapX:!0,tileGrid:tileGrid}),tileLayer=new _vendor.ol.layer.Tile({opacity:layer.opacity||1,source:tileSource});return tileLayer.progress="",tileSource.setTileLoadFunction(this.tileLoaderHook(tileSource,tileLayer)),layer.refresh&&(tileLayer.set("updated",(0,_vendor.moment)().toLocaleString()),tileLayer.refresh=setInterval(function(){tileLayer.set("updated",(0,_vendor.moment)().toLocaleString()),tileSource.setUrl(layer.wmts_url+"?time="+_vendor.moment.utc().unix())},1e3*layer.refresh)),tileLayer.set("name",layer.name),tileLayer.set("id",layer.id),tileLayer},searchKeyFix:function(ev){13==ev.keyCode&&this.runSearch()},runSearch:function(){var vm=this,query=(0,_vendor.$)("#map-search").get(0).value;if(query){var victory=function(coords,name){vm.animatePan(coords),vm.animateZoom(vm.resolutions[10]),console.log([name,coords[0],coords[1]])},dms=this.parseDMSString(query);if(dms)return void victory(dms,this.getDMS(dms));var mga=this.parseMGAString(query);if(mga)return void victory(mga.coords,this.getMGA(mga.coords));var fd=this.parseFDString(query);return fd?void this.queryFD(fd.fdNorth+" "+fd.fdEast,victory):void this.queryGeocode(query,victory)}},getMapLayer:function(id){return id&&id.id&&(id=id.id),this.olmap.getLayers().getArray().find(function(layer){return layer.get("id")===id})},init:function(catalogue,layers,options){var vm=this;options=options||{},this.$root.catalogue.catalogue.extend(catalogue);var initialLayers=layers.reverse().map(function(value){var layer=_vendor.$.extend(vm.$root.catalogue.getLayer(value[0]),value[1]);return vm["create"+layer.type](layer)});_vendor.proj4.defs("EPSG:28349","+proj=utm +zone=49 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28350","+proj=utm +zone=50 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28351","+proj=utm +zone=51 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28352","+proj=utm +zone=52 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28353","+proj=utm +zone=53 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28354","+proj=utm +zone=54 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28355","+proj=utm +zone=55 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),_vendor.proj4.defs("EPSG:28356","+proj=utm +zone=56 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),this.olmap=new _vendor.ol.Map({logo:!1,renderer:"canvas",target:"map",layers:initialLayers,view:new _vendor.ol.View({projection:"EPSG:4326",center:vm.view.center,zoom:6,maxZoom:21,minZoom:5}),controls:[new _vendor.ol.control.Zoom,new _vendor.ol.control.ScaleLine,new _vendor.ol.control.FullScreen({source:(0,_vendor.$)("body").get(0),label:(0,_vendor.$)("<i/>",{class:"fa fa-expand"})[0]}),new _vendor.ol.control.Control({element:(0,_vendor.$)("#menu-scale").get(0)}),new _vendor.ol.control.Control({element:(0,_vendor.$)("#map-search").get(0)}),new _vendor.ol.control.Control({element:(0,_vendor.$)("#map-search-button").get(0)}),new _vendor.ol.control.Attribution],interactions:_vendor.ol.interaction.defaults({altShiftDragRotate:!1,pinchRotate:!1,dragPan:!1,doubleClickZoom:!1,keyboard:!1})}),this.setScale(this.view.scale/1e3),this.olmap.addInteraction(this.dragPanInter),this.olmap.addInteraction(this.doubleClickZoomInter),this.olmap.addInteraction(this.keyboardPanInter),this.olmap.addInteraction(this.keyboardZoomInter),this.olmap.addInteraction(this.middleDragPanInter),this.graticule.setMap(this.olmap),this.olmap.on("postrender",function(){vm.scale=vm.getScale(),vm.$els.scale.selectedIndex=0}),this.$root.$broadcast("gk-init")}},ready:function(){_vendor.$.each(this.matrixSets,function(projection,innerMatrixSets){_vendor.$.each(innerMatrixSets,function(tileSize,matrixSet){for(var matrixIds=new Array(matrixSet.maxLevel-matrixSet.minLevel+1),z=matrixSet.minLevel;z<=matrixSet.maxLevel;++z)matrixIds[z]=matrixSet.name+":"+z;matrixSet.matrixIds=matrixIds})})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class=map id=map tabindex=0><gk-info v-ref:info=""></gk-info><select v-el:scale="" @change=setScale($event.target.value) id=menu-scale v-cloak=""><option value="{{ scale }}" selected>{{ scaleString }}<option v-for="s in fixedScales" value="{{ s }}">{{ getScaleString(s) }}</select><input id=map-search placeholder="Search (places, °, MGA, FD)" @keyup=searchKeyFix($event)> <button id=map-search-button @click=runSearch><i class="fa fa-search"></i></button></div>'},{"./info.vue":6,"src/vendor.js":"src/vendor.js"}],13:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _vendor=require("src/vendor.js");exports.default={data:function(){return{viewportOnly:!0,toggleHistory:!1,selectedOnly:!1,search:"",cql:"",history:"",fields:["id","name","callsign","make","model","rego","category","deviceid","symbol"],allFeatures:[],extentFeatures:[],selectedDevices:[],historyFromDate:"",historyFromTime:"",historyToDate:"",historyToTime:"",historyRangeMilliseconds:0}},computed:{features:function(){return this.viewportOnly?this.extentFeatures:this.allFeatures},selectedFeatures:function(){return this.features.filter(this.selected)},stats:function(){return Object.keys(this.extentFeatures).length+"/"+Object.keys(this.allFeatures).length},historyRange:{get:function(){return this.historyRangeMilliseconds},set:function(val){this.historyRangeMilliseconds=val;var currentDate=(0,_vendor.moment)();this.historyToDate=currentDate.format("YYYY-MM-DD"),this.historyToTime=currentDate.format("HH:mm");var fromDate=currentDate.subtract(val,"milliseconds");this.historyFromDate=fromDate.format("YYYY-MM-DD"),this.historyFromTime=fromDate.format("HH:mm")}},trackingLayer:function(){return this.$root.catalogue.getLayer("dpaw:resource_tracking_live")},trackingMapLayer:function(){return this.$root.map.getMapLayer(this.trackingLayer)}},methods:{ago:function(time){var now=(0,_vendor.moment)();return 1==now.diff((0,_vendor.moment)(time),"days")?now.diff((0,_vendor.moment)(time),"days")+" day":now.diff((0,_vendor.moment)(time),"days")>1?now.diff((0,_vendor.moment)(time),"days")+" days":1==now.diff((0,_vendor.moment)(time),"hours")?now.diff((0,_vendor.moment)(time),"hours")+" hr":now.diff((0,_vendor.moment)(time),"hours")>1?now.diff((0,_vendor.moment)(time),"hours")+" hrs":1==now.diff((0,_vendor.moment)(time),"minutes")?now.diff((0,_vendor.moment)(time),"minutes")+" min":now.diff((0,_vendor.moment)(time),"minutes")<1?"<1 min":now.diff((0,_vendor.moment)(time),"minutes")+" mins"},toggleSelect:function(f){this.selected(f)?this.$root.annotations.selectedFeatures.remove(f):this.$root.annotations.selectedFeatures.push(f)},selected:function(f){return f.get("deviceid")&&this.selectedDevices.indexOf(f.get("deviceid"))>-1},downloadList:function(){this.$root.export.exportVector(this.features.filter(this.resourceFilter).sort(this.resourceOrder),"trackingdata")},clearHistory:function(){if(!this.toggleHistory){var historyLayer=this.$root.catalogue.getLayer("dpaw:resource_tracking_history");historyLayer.cql_filter="clearhistorylayer",this.$root.catalogue.onLayerChange(historyLayer,!1)}},updateCQLFilter:function(){var vm=this,groupFilter=this.cql,deviceFilter="";this.selectedDevices.length>0&&this.selectedOnly&&(deviceFilter="deviceid in ("+this.selectedDevices.join(",")+")"),groupFilter&&deviceFilter?this.trackingLayer.cql_filter="("+groupFilter+") and ("+deviceFilter+")":deviceFilter?this.trackingLayer.cql_filter=deviceFilter:this.trackingLayer.cql_filter=groupFilter,this.trackingMapLayer.set("updated",(0,_vendor.moment)().toLocaleString()),this.trackingMapLayer.getSource().loadSource(function(){vm.updateTracking()})},historyCQLFilter:function(){var vm=this,historyLayer=this.$root.catalogue.getLayer("dpaw:resource_tracking_history"),deviceFilter="deviceid in ("+this.selectedDevices.join(",")+")";historyLayer.cql_filter=deviceFilter+"and seen between '"+this.historyFromDate+" "+this.historyFromTime+":00' and '"+this.historyToDate+" "+this.historyToTime+":00'",this.$root.catalogue.onLayerChange(historyLayer,!0);var source=this.$root.map.getMapLayer(historyLayer).getSource();source.loadSource(function(){var devices={};source.getFeatures().forEach(function(feature){var props=feature.getProperties();props.name in devices||(devices[props.name]=[]),devices[props.name].push(feature)}),Object.keys(devices).forEach(function(device){devices[device].sort(vm.resourceOrder);var coords=devices[device].map(function(point){return point.set("label",(0,_vendor.moment)(point.get("seen")).format("MMM DD HH:mm")),point.getGeometry().getCoordinates()}),feature=new _vendor.ol.Feature({name:device+" path",geometry:new _vendor.ol.geom.LineString(coords)});source.addFeature(feature)})})},resourceFilter:function(f){var search=(""+this.search).toLowerCase(),found=!search||this.fields.some(function(key){return(""+f.get(key)).toLowerCase().indexOf(search)>-1});return this.selectedOnly?this.selected(f)&&found:found},resourceOrder:function(a,b){var as=a.get("seen"),bs=b.get("seen");return as<bs?1:as>bs?-1:0},zoomToSelected:function(){var extent=_vendor.ol.extent.createEmpty();this.selectedFeatures.forEach(function(f){_vendor.ol.extent.extend(extent,f.getGeometry().getExtent())});var map=this.$root.map.olmap;map.getView().fit(extent,map.getSize())},updateTracking:function(){var mapLayer=this.$root.map.getMapLayer(this.$root.catalogue.getLayer("dpaw:resource_tracking_live"));mapLayer&&(this.extentFeatures=mapLayer.getSource().getFeaturesInExtent(this.$root.export.mapLayout.extent).filter(this.resourceFilter),this.extentFeatures.sort(this.resourceOrder),this.allFeatures=mapLayer.getSource().getFeatures().filter(this.resourceFilter),this.allFeatures.sort(this.resourceOrder))},init:function(){this.$root.annotations.selectable=[this.trackingMapLayer],this.$root.annotations.setTool("Select"),this.$root.tracking.updateCQLFilter()}},ready:function(){var vm=this,map=this.$root.map;this.$on("gk-init",function(){var trackingLayer=this.$root.catalogue.getLayer("dpaw:resource_tracking_live"),renderTracking=global.debounce(function(){var mapLayer=map.getMapLayer(trackingLayer);mapLayer&&(mapLayer.get("tracking")||(mapLayer.set("tracking",mapLayer.on("propertychange",function(event){"updated"===event.key&&vm.updateTracking()})),mapLayer.set("updated",(0,_vendor.moment)().toLocaleString())))},100),viewChanged=global.debounce(function(){vm.updateTracking()},100);map.olmap.getLayerGroup().on("change",renderTracking),map.olmap.getView().on("propertychange",viewChanged),this.$root.annotations.selectedFeatures.on("add",function(event){event.element.get("deviceid")&&vm.selectedDevices.push(event.element.get("deviceid"))}),this.$root.annotations.selectedFeatures.on("remove",function(event){event.element.get("deviceid")&&vm.selectedDevices.$remove(event.element.get("deviceid"))})})}},module.exports.__esModule&&(module.exports=module.exports.default),("function"==typeof module.exports?module.exports.options:module.exports).template='<div class=tabs-panel id=menu-tab-tracking><div class="row collapse"><div class=columns><ul class=tabs data-tabs="" id=tracking-tabs><li class="tabs-title is-active"><a href=#tracking-list-tab aria-selected=true>Resource Tracking</a></ul></div></div><div class="row collapse" id=tracking-tab-panels><div class=columns><div class="tabs-content vertical" data-tabs-content=tracking-tabs><div id=tracking-list-tab class="tabs-panel is-active" v-cloak=""><div class=row><div class="switch tiny"><input class=switch-input id=resourcesInViewport type=checkbox v-model=viewportOnly><label class=switch-paddle for=resourcesInViewport><span class=show-for-sr>Viewport resources only</span></label></div><label for=resourcesInViewport class=side-label>Restrict to viewport ({{ stats }})</label></div><div class="row collapse"><div class="small-6 columns"><select name=select v-model=cql @change=updateCQLFilter><option value="" selected>All resources<option value="symbolid LIKE \'%comms_bus\'">Communications Bus<option value="symbolid LIKE \'%gang_truck\'">Gang Truck<option value="symbolid LIKE \'%heavy_duty\'">Heavy Duty<option value="(symbolid LIKE \'%heavy_duty\' OR symbolid LIKE \'%gang_truck\')">GT and HD<option value="(symbolid LIKE \'%dozer\' OR symbolid LIKE \'%grader\' OR symbolid LIKE \'%loader\')">Machinery<option value="symbolid LIKE \'%aircraft\'">Aircraft</select></div><div class="small-6 columns"><input type=search v-model=search placeholder="Find a resource" @keyup="updateCQLFilter | debounce 700"></div></div><div class=row><div class=small-9><div class=columns><div class=row><div class="switch tiny"><input class=switch-input id=resourceHistory type=checkbox v-model=toggleHistory @change=clearHistory><label class=switch-paddle for=resourceHistory><span class=show-for-sr>Query history</span></label></div><label for=resourceHistory class=side-label>Query history</label></div></div><div class=columns><div class=row><div class="switch tiny"><input class=switch-input id=selectedOnly type=checkbox v-model=selectedOnly @change=updateCQLFilter><label class=switch-paddle for=selectedOnly><span class=show-for-sr>Show selected only</span></label></div><label for=selectedOnly class=side-label>Show selected only</label></div></div></div><div class=small-3><a title="Zoom to selected" class="button float-right" @click=zoomToSelected()><i class="fa fa-search"></i></a> <a title="Download list" class=button @click=downloadList()><i class="fa fa-download"></i></a></div></div><div id=history-panel v-if=toggleHistory><div class="row collapse tool-slice"><div class=small-2><label for=historyFrom>From:</label></div><div class=small-4><input type=text v-model=historyFromDate placeholder=yyyy-mm-dd></div><div class=small-2><input type=text v-model=historyFromTime placeholder=24:00></div><div class=small-4><select name=select v-model=history @change="historyRange = history"><option value="" selected>Date range<option value=3600000>Last hour<option value=10800000>Last 3 hours<option value=86400000>Last day<option value=604800000>Last week<option value=2678400000>Last month</select></div></div><div class="row collapse tool-slice"><div class=small-2><label for=historyTo>To:</label></div><div class=small-4><input type=text v-model=historyToDate placeholder=yyyy-mm-dd></div><div class=small-2><input type=text v-model=historyToTime placeholder=24:00></div><div class=small-2></div><div class=small-2><button class=button style="float: right" @click=historyCQLFilter>Go</button></div></div></div><div id=tracking-list><div v-for="f in features" class="row feature-row" v-bind:class="{\'device-selected\': selected(f) }" @click=toggleSelect(f) track-by="get(\'id\')"><div class=columns><a @click.stop="" href="https://sss.dpaw.wa.gov.au/admin/tracking/device/{{ f.get(\'id\') }}/change/" target=_blank class="button small secondary float-right"><i class="fa fa-pencil"></i></a><div class=feature-title><img class=feature-icon v-bind:src="$root.$refs.app.getBlob(f, [\'icon\', \'tint\'])"> {{ f.get(\'label\') }} <i><small>({{ ago(f.get(\'seen\')) }})</small></i></div></div></div></div></div></div></div></div></div>'}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"src/vendor.js":"src/vendor.js"}]},{},[3]);
